'use strict';
const _0x5dd430 = _0x552a;
(function (_0x3df55f, _0x28ac00) {
    const _0x99ba13 = _0x552a, _0x51dcfe = _0x3df55f();
    while (!![]) {
        try {
            const _0x4e2780 = -parseInt(_0x99ba13(0x120)) / (0x5 * 0x4c9 + 0x28d * 0x2 + -0x2 * 0xe83) + parseInt(_0x99ba13(0x12a)) / (-0x1b1b + 0x26ff + -0xbe2) + parseInt(_0x99ba13(0xc0)) / (0x59f * 0x6 + -0x32 + -0x1 * 0x2185) * (-parseInt(_0x99ba13(0x98)) / (-0x1df2 + -0xdb1 + 0x2ba7)) + parseInt(_0x99ba13(0xcc)) / (-0x134d + -0x1 * -0xaf3 + -0x1 * -0x85f) * (-parseInt(_0x99ba13(0x10b)) / (-0x16 * -0x61 + 0x1 * -0xaba + 0x26a)) + parseInt(_0x99ba13(0x9e)) / (-0x3 * -0x8ff + 0x12e1 + 0x92b * -0x5) * (-parseInt(_0x99ba13(0x125)) / (-0xd * 0x12e + 0x1887 + 0x5 * -0x1d5)) + -parseInt(_0x99ba13(0x8a)) / (-0x1f6f + -0x14a * 0xa + 0x2 * 0x162e) + parseInt(_0x99ba13(0xbd)) / (0xeb1 + 0x8d5 * 0x1 + -0x177c);
            if (_0x4e2780 === _0x28ac00)
                break;
            else
                _0x51dcfe['push'](_0x51dcfe['shift']());
        } catch (_0x4df8a6) {
            _0x51dcfe['push'](_0x51dcfe['shift']());
        }
    }
}(_0x1a90, -0x19 * 0x25f2 + -0x5fb7b + 0xd268f));
function _0x552a(_0x4a04ab, _0x1d17bd) {
    const _0x405973 = _0x1a90();
    return _0x552a = function (_0x55e913, _0x4495f7) {
        _0x55e913 = _0x55e913 - (-0x136e + -0x6 * -0x15f + 0xbb1);
        let _0x5053a8 = _0x405973[_0x55e913];
        return _0x5053a8;
    }, _0x552a(_0x4a04ab, _0x1d17bd);
}
var __awaiter = this && this[_0x5dd430(0xdb)] || function (_0x4ae931, _0x396f71, _0x1d7a73, _0x1ddf53) {
        const _0x5e68bf = _0x5dd430, _0x4b69d1 = {
                'gvHsb': function (_0x1bde19, _0x292564) {
                    return _0x1bde19(_0x292564);
                },
                'nhDDN': function (_0x4ee1e3, _0x1eae4e) {
                    return _0x4ee1e3 instanceof _0x1eae4e;
                },
                'CXQEm': function (_0x33eeed, _0x1479d6) {
                    return _0x33eeed(_0x1479d6);
                },
                'anEte': function (_0x3f3aaf, _0x157ab6) {
                    return _0x3f3aaf(_0x157ab6);
                },
                'DBFEP': _0x5e68bf(0x113),
                'sMndb': function (_0x14a9a2, _0x529ea4) {
                    return _0x14a9a2(_0x529ea4);
                },
                'UNjuF': function (_0xac2165, _0x2f5bab) {
                    return _0xac2165(_0x2f5bab);
                }
            };
        function _0x5dc14d(_0x53e5ef) {
            const _0x108327 = _0x5e68bf;
            return _0x4b69d1[_0x108327(0x93)](_0x53e5ef, _0x1d7a73) ? _0x53e5ef : new _0x1d7a73(function (_0x3749d9) {
                const _0x502b12 = _0x108327;
                _0x4b69d1[_0x502b12(0x107)](_0x3749d9, _0x53e5ef);
            });
        }
        return new (_0x1d7a73 || (_0x1d7a73 = Promise))(function (_0x53d994, _0x160272) {
            const _0x2d2588 = _0x5e68bf;
            function _0x435032(_0x121717) {
                const _0x256579 = _0x552a;
                try {
                    _0x4b69d1[_0x256579(0xaa)](_0xb09e52, _0x1ddf53[_0x256579(0x119)](_0x121717));
                } catch (_0x596676) {
                    _0x4b69d1[_0x256579(0xd9)](_0x160272, _0x596676);
                }
            }
            function _0x496e60(_0x21f33f) {
                const _0x3e0556 = _0x552a;
                try {
                    _0x4b69d1[_0x3e0556(0xd9)](_0xb09e52, _0x1ddf53[_0x4b69d1[_0x3e0556(0x109)]](_0x21f33f));
                } catch (_0x27e260) {
                    _0x4b69d1[_0x3e0556(0x107)](_0x160272, _0x27e260);
                }
            }
            function _0xb09e52(_0x19d01d) {
                const _0x5c0342 = _0x552a;
                _0x19d01d[_0x5c0342(0xcd)] ? _0x4b69d1[_0x5c0342(0xaa)](_0x53d994, _0x19d01d[_0x5c0342(0xc6)]) : _0x4b69d1[_0x5c0342(0x11d)](_0x5dc14d, _0x19d01d[_0x5c0342(0xc6)])[_0x5c0342(0xa9)](_0x435032, _0x496e60);
            }
            _0x4b69d1[_0x2d2588(0xdf)](_0xb09e52, (_0x1ddf53 = _0x1ddf53[_0x2d2588(0xd7)](_0x4ae931, _0x396f71 || []))[_0x2d2588(0x119)]());
        });
    }, __importDefault = this && this[_0x5dd430(0xfa) + _0x5dd430(0xd0)] || function (_0x1aa9c8) {
        const _0x38b777 = _0x5dd430;
        return _0x1aa9c8 && _0x1aa9c8[_0x38b777(0xe1)] ? _0x1aa9c8 : { 'default': _0x1aa9c8 };
    };
const _0x49d5c4 = {};
_0x49d5c4[_0x5dd430(0xc6)] = !![], Object[_0x5dd430(0x111) + _0x5dd430(0x110)](exports, _0x5dd430(0xe1), _0x49d5c4);
const pupa_1 = require(_0x5dd430(0x80) + _0x5dd430(0xa0)), logger_1 = require(_0x5dd430(0x80) + _0x5dd430(0xad)), Ticket_1 = __importDefault(require(_0x5dd430(0x115) + _0x5dd430(0x81))), Message_1 = __importDefault(require(_0x5dd430(0x115) + _0x5dd430(0xf6))), socketEmit_1 = __importDefault(require(_0x5dd430(0x10e) + _0x5dd430(0x9b) + _0x5dd430(0xdd))), UpdateContactTagsBotService_1 = __importDefault(require(_0x5dd430(0x88) + _0x5dd430(0xfe) + _0x5dd430(0xda) + _0x5dd430(0xed) + _0x5dd430(0xb4))), axios_1 = __importDefault(require(_0x5dd430(0xa1))), ShowTicketService_1 = __importDefault(require(_0x5dd430(0xee) + _0x5dd430(0x103) + _0x5dd430(0xe8) + _0x5dd430(0x106))), VerifyStepsChatFlowTicket_1 = __importDefault(require(_0x5dd430(0x92) + _0x5dd430(0x108) + _0x5dd430(0x8f))), BuildSendMessageService = ({
        msg: _0x124421,
        tenantId: _0x3524fa,
        ticket: _0x31498a,
        userId: _0x1f6e7b
    }) => __awaiter(void (-0x97b + 0x8f * 0x16 + 0x2cf * -0x1), void (0xd * 0x76 + -0xc52 + 0xa2 * 0xa), void (-0x209 + 0x2680 + -0x2477), function* () {
        const _0x1d25d2 = _0x5dd430, _0x3eb47f = {
                'MFbsU': function (_0x32adc6, _0x35990d) {
                    return _0x32adc6(_0x35990d);
                },
                'KGREt': function (_0x5540ae, _0x4c7690, _0x1f1899, _0x47b2eb, _0x41b9bf) {
                    return _0x5540ae(_0x4c7690, _0x1f1899, _0x47b2eb, _0x41b9bf);
                },
                'vopvP': _0x1d25d2(0xc8),
                'mOCkW': _0x1d25d2(0xe0),
                'XNrBF': _0x1d25d2(0xf3),
                'hkdkp': function (_0x460d4f, _0x3c4b5d) {
                    return _0x460d4f === _0x3c4b5d;
                },
                'clyTz': _0x1d25d2(0xef) + _0x1d25d2(0x118),
                'yTfwS': _0x1d25d2(0x127),
                'bPYjz': _0x1d25d2(0x112) + _0x1d25d2(0xa4),
                'cHWmH': _0x1d25d2(0xf9) + _0x1d25d2(0x97) + _0x1d25d2(0x121),
                'ftApP': _0x1d25d2(0xc9) + 'ld',
                'pcYfE': function (_0x448b6b, _0x4eeb3c) {
                    return _0x448b6b === _0x4eeb3c;
                },
                'YWdyB': function (_0x3b4995, _0x2cf93e) {
                    return _0x3b4995 === _0x2cf93e;
                },
                'Tzzfj': function (_0xb09f18, _0x181eca) {
                    return _0xb09f18 === _0x181eca;
                },
                'zJQiZ': function (_0xce9492, _0x43dc57) {
                    return _0xce9492 === _0x43dc57;
                },
                'bZImM': function (_0x36a635, _0x21e2a4) {
                    return _0x36a635 === _0x21e2a4;
                },
                'VLVzx': function (_0x50bd7e, _0x28582a) {
                    return _0x50bd7e === _0x28582a;
                },
                'nRjMH': function (_0x42b77e, _0x3d0bf7) {
                    return _0x42b77e === _0x3d0bf7;
                },
                'qMTQN': function (_0x555d9c, _0x227e24) {
                    return _0x555d9c === _0x227e24;
                },
                'aGxJG': function (_0x27cd3a, _0x3592c5) {
                    return _0x27cd3a === _0x3592c5;
                },
                'YpZhj': function (_0x1b91e9, _0x428549) {
                    return _0x1b91e9 === _0x428549;
                },
                'HJfOV': function (_0x1cfa10, _0x17b8c3) {
                    return _0x1cfa10 === _0x17b8c3;
                },
                'WWfWL': function (_0x1a56ed, _0x2b3847) {
                    return _0x1a56ed === _0x2b3847;
                },
                'kFsST': function (_0x2bd072, _0x188dee) {
                    return _0x2bd072 === _0x188dee;
                },
                'MEpdL': function (_0x12aad3, _0x50f835) {
                    return _0x12aad3 === _0x50f835;
                },
                'ntpOm': function (_0x5326a8, _0xafb372) {
                    return _0x5326a8 === _0xafb372;
                },
                'goOdV': _0x1d25d2(0x99),
                'bdmfX': function (_0x3f0410, _0x2e4296) {
                    return _0x3f0410 === _0x2e4296;
                },
                'eeNio': _0x1d25d2(0x116),
                'QdBBL': _0x1d25d2(0xcb),
                'qKXHh': function (_0xaf7d6f, _0x54a0fa) {
                    return _0xaf7d6f * _0x54a0fa;
                },
                'TbTTw': function (_0x57d246) {
                    return _0x57d246();
                },
                'qmpHU': function (_0x41d77d, _0x25acc8) {
                    return _0x41d77d === _0x25acc8;
                },
                'cwIjO': _0x1d25d2(0xc7),
                'CjyAz': function (_0x2b7263, _0x3c858a) {
                    return _0x2b7263 - _0x3c858a;
                },
                'WcCGZ': function (_0x406d17, _0x12f6c0) {
                    return _0x406d17 === _0x12f6c0;
                },
                'OlTLc': function (_0x562fe8, _0x143a54) {
                    return _0x562fe8 === _0x143a54;
                },
                'fJwVn': _0x1d25d2(0xc4),
                'dkqWa': _0x1d25d2(0x11e),
                'ZnLMt': _0x1d25d2(0xec),
                'ZbLVJ': _0x1d25d2(0xce) + _0x1d25d2(0x85) + _0x1d25d2(0x122),
                'OqXUd': _0x1d25d2(0x8d) + 'e',
                'cQlzO': function (_0x4cafdb, _0x4a192f) {
                    return _0x4cafdb !== _0x4a192f;
                },
                'BWFQb': function (_0x761e15, _0x2fe9bc) {
                    return _0x761e15 !== _0x2fe9bc;
                },
                'uqYnI': function (_0x30e2fd, _0x182235) {
                    return _0x30e2fd === _0x182235;
                },
                'dxenh': function (_0x1148cd, _0x12d0d1) {
                    return _0x1148cd === _0x12d0d1;
                },
                'xNJiB': function (_0x125932, _0x492d44) {
                    return _0x125932 === _0x492d44;
                },
                'nSYUN': function (_0x1e4f3, _0x176390) {
                    return _0x1e4f3 === _0x176390;
                },
                'NoFvP': function (_0x525a75, _0x1bac51) {
                    return _0x525a75 === _0x1bac51;
                },
                'VrygK': function (_0x9a7637, _0x8b534d) {
                    return _0x9a7637 === _0x8b534d;
                },
                'JTVjo': function (_0xe1e64f, _0x2ee4a1) {
                    return _0xe1e64f === _0x2ee4a1;
                },
                'QUMej': function (_0x20393c, _0x37b41c) {
                    return _0x20393c === _0x37b41c;
                },
                'jSprW': function (_0x5cd038, _0x58f6da) {
                    return _0x5cd038 === _0x58f6da;
                },
                'gcdxe': function (_0x4d1e9f, _0x4dc936) {
                    return _0x4d1e9f === _0x4dc936;
                },
                'jLLvf': function (_0x4f91e2, _0x25b774) {
                    return _0x4f91e2 === _0x25b774;
                },
                'IyVbT': function (_0x1faa7f, _0x5631fe) {
                    return _0x1faa7f === _0x5631fe;
                },
                'yNlIR': function (_0x3d49b1, _0x50aa9b) {
                    return _0x3d49b1 === _0x50aa9b;
                },
                'dzdYi': function (_0xcc88bf, _0x4e8921) {
                    return _0xcc88bf === _0x4e8921;
                }
            };
        var _0x40b66f, _0x36efe8, _0x1c128c, _0x42e04e, _0x528056, _0x359a35, _0x195ad3, _0x342aa1, _0x1ba35d, _0x1b2858, _0x4bde40, _0x3ef715, _0x5c812b;
        const _0x2ef01a = {
            'ticketId': _0x31498a['id'],
            'body': '',
            'contactId': _0x31498a[_0x1d25d2(0xf5)],
            'fromMe': !![],
            'read': !![],
            'mediaType': _0x3eb47f[_0x1d25d2(0x7f)],
            'mediaUrl': undefined,
            'timestamp': new Date()[_0x1d25d2(0x11c)](),
            'quotedMsgId': undefined,
            'userId': _0x1f6e7b,
            'scheduleDate': undefined,
            'sendType': _0x3eb47f[_0x1d25d2(0xd5)],
            'status': _0x3eb47f[_0x1d25d2(0xca)],
            'tenantId': _0x3524fa
        };
        try {
            if (_0x3eb47f[_0x1d25d2(0x90)](_0x124421[_0x1d25d2(0x11f)], _0x3eb47f[_0x1d25d2(0xe9)]) && _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0xff)])
                try {
                    const _0x526d07 = {};
                    _0x526d07[_0x1d25d2(0xb7)] = _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0xff)], _0x526d07[_0x1d25d2(0x117) + 'ow'] = _0x3eb47f[_0x1d25d2(0xf8)], _0x526d07[_0x1d25d2(0x96)] = ![], _0x526d07[_0x1d25d2(0xf7)] = !![], yield _0x31498a[_0x1d25d2(0xd6)](_0x526d07);
                    const _0x236e2b = {};
                    _0x236e2b['id'] = _0x31498a['id'], _0x236e2b[_0x1d25d2(0xb1)] = _0x31498a[_0x1d25d2(0xb1)];
                    const _0x16dc1a = yield (-0x25 * -0x41 + 0xe7b * -0x1 + -0xd9 * -0x6, ShowTicketService_1[_0x1d25d2(0xa2)])(_0x236e2b), _0x5f57cb = {};
                    _0x5f57cb[_0x1d25d2(0xb1)] = _0x31498a[_0x1d25d2(0xb1)], _0x5f57cb[_0x1d25d2(0x11f)] = _0x3eb47f[_0x1d25d2(0x10a)], _0x5f57cb[_0x1d25d2(0xf2)] = _0x16dc1a, (0x1723 + -0x104a + -0x6d9, socketEmit_1[_0x1d25d2(0xa2)])(_0x5f57cb);
                    const _0x3a1661 = {};
                    _0x3a1661[_0x1d25d2(0x8e)] = _0x31498a[_0x1d25d2(0x86) + 'e'], _0x3a1661[_0x1d25d2(0xeb)] = ![];
                    const _0x57e8b5 = _0x3a1661;
                    yield (-0x2281 + 0x1cbf + 0x5c2, VerifyStepsChatFlowTicket_1[_0x1d25d2(0xa2)])(_0x57e8b5, _0x31498a);
                } catch (_0x5dfe19) {
                    logger_1[_0x1d25d2(0x84)][_0x1d25d2(0xde)](_0x3eb47f[_0x1d25d2(0xaf)], _0x5dfe19);
                }
            if (_0x3eb47f[_0x1d25d2(0x90)](_0x124421[_0x1d25d2(0x11f)], _0x3eb47f[_0x1d25d2(0x8c)]) && _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0x126)]) {
                if (_0x3eb47f[_0x1d25d2(0x90)](_0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0x126)], ''))
                    return;
                try {
                    _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0x126)] = (-0x112 + 0x4 * -0x125 + 0x5a6, pupa_1[_0x1d25d2(0x9c)])(_0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0x126)] || '', {
                        'protocol': (_0x3eb47f[_0x1d25d2(0x90)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0xa7)](_0x31498a, void (-0x1 * -0x1909 + 0x1 * -0x5cf + -0x133a)) ? void (-0x1982 + -0x26c9 + 0x404b) : _0x31498a[_0x1d25d2(0xbb)]) || '',
                        'name': (_0x3eb47f[_0x1d25d2(0xcf)](_0x40b66f = _0x3eb47f[_0x1d25d2(0x90)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0x9a)](_0x31498a, void (0x80e + 0x1 * -0x1523 + 0x1 * 0xd15)) ? void (0x7 * 0x4c1 + 0x1acd * -0x1 + -0x67a) : _0x31498a[_0x1d25d2(0x11e)], null) || _0x3eb47f[_0x1d25d2(0xa7)](_0x40b66f, void (-0x2031 + 0xb2c + 0x1505)) ? void (0x5d0 + -0x20a8 * 0x1 + 0x1ad8) : _0x40b66f[_0x1d25d2(0x100)]) || '',
                        'email': (_0x3eb47f[_0x1d25d2(0xbe)](_0x36efe8 = _0x3eb47f[_0x1d25d2(0x7e)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0xbe)](_0x31498a, void (0x24 * 0x35 + 0x6e2 + 0xe56 * -0x1)) ? void (-0x201e + 0x1 * -0x1a3 + 0x1 * 0x21c1) : _0x31498a[_0x1d25d2(0x11e)], null) || _0x3eb47f[_0x1d25d2(0x95)](_0x36efe8, void (-0xc9b + 0x1 * 0x175 + 0xb26)) ? void (-0x1e7a + -0x2f8 * 0x4 + 0x2a5a) : _0x36efe8[_0x1d25d2(0xb3)]) || '',
                        'phoneNumber': (_0x3eb47f[_0x1d25d2(0x9a)](_0x1c128c = _0x3eb47f[_0x1d25d2(0xe7)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0xab)](_0x31498a, void (0x1560 + 0xd * 0x25f + -0x3433)) ? void (-0x12c + -0x1340 + 0x146c) : _0x31498a[_0x1d25d2(0x11e)], null) || _0x3eb47f[_0x1d25d2(0x7e)](_0x1c128c, void (-0x205d * 0x1 + 0x1221 + -0x1 * -0xe3c)) ? void (-0x1572 + -0x8b3 + 0x1e25) : _0x1c128c[_0x1d25d2(0xa3)]) || '',
                        'kanban': (_0x3eb47f[_0x1d25d2(0xc5)](_0x42e04e = _0x3eb47f[_0x1d25d2(0x123)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0x9d)](_0x31498a, void (0x2 * 0xf16 + -0x1 * 0xa53 + 0x1 * -0x13d9)) ? void (0xa9 + -0x26d1 + 0x6f * 0x58) : _0x31498a[_0x1d25d2(0x11e)], null) || _0x3eb47f[_0x1d25d2(0x90)](_0x42e04e, void (0x158d * -0x1 + -0x53f * 0x7 + 0x2 * 0x1d23)) ? void (-0x53 * 0x59 + -0x12fd + 0x2 * 0x17ec) : _0x42e04e[_0x1d25d2(0x129)]) || '',
                        'user': (_0x3eb47f[_0x1d25d2(0xb6)](_0x528056 = _0x3eb47f[_0x1d25d2(0x94)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0x82)](_0x31498a, void (0x1 * 0x1e92 + 0x1961 * -0x1 + 0x1bb * -0x3)) ? void (-0x3 * -0xb7b + 0xba9 + -0x2e1a) : _0x31498a[_0x1d25d2(0x101)], null) || _0x3eb47f[_0x1d25d2(0x82)](_0x528056, void (-0x3 * 0x28d + -0x1e79 + 0x1 * 0x2620)) ? void (0x1383 + -0x847 * -0x2 + -0x2411) : _0x528056[_0x1d25d2(0x100)]) || '',
                        'userEmail': (_0x3eb47f[_0x1d25d2(0x94)](_0x359a35 = _0x3eb47f[_0x1d25d2(0xab)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0x9f)](_0x31498a, void (0x1 * 0x1a11 + 0x2 * -0xe89 + 0x301)) ? void (0x561 + -0x217f * 0x1 + 0xe0f * 0x2) : _0x31498a[_0x1d25d2(0x101)], null) || _0x3eb47f[_0x1d25d2(0xab)](_0x359a35, void (0x57c + -0x7 * -0x4cc + -0x2710)) ? void (0x1 * 0x1825 + -0x22c2 * -0x1 + -0x3ae7) : _0x359a35[_0x1d25d2(0xb3)]) || ''
                    }), _0x3eb47f[_0x1d25d2(0x82)](typeof _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0x126)], _0x3eb47f[_0x1d25d2(0xb9)]) && (yield axios_1[_0x1d25d2(0xa2)][_0x1d25d2(0xae)](_0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0x126)]));
                } catch (_0x1be61c) {
                    logger_1[_0x1d25d2(0x84)][_0x1d25d2(0xde)](_0x3eb47f[_0x1d25d2(0xaf)], _0x1be61c);
                }
            }
            if (_0x3eb47f[_0x1d25d2(0x7d)](_0x124421[_0x1d25d2(0x11f)], _0x3eb47f[_0x1d25d2(0xb5)]) && _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0xd4)]) {
                if (_0x3eb47f[_0x1d25d2(0x90)](_0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0xd4)], null))
                    return;
                yield (-0x151 * -0x3 + -0x1f56 + 0x9 * 0x30b, UpdateContactTagsBotService_1[_0x1d25d2(0xa2)])({
                    'tagId': _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0xd4)],
                    'contactId': _0x31498a[_0x1d25d2(0xf5)][_0x1d25d2(0xc2)](),
                    'tenantId': _0x3524fa
                });
            }
            if (_0x3eb47f[_0x1d25d2(0xe7)](_0x124421[_0x1d25d2(0x11f)], _0x3eb47f[_0x1d25d2(0xa8)]) && _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0x114)]) {
                const _0x20dc80 = _0x3a049e => new Promise(_0x5b2a9f => setTimeout(_0x5b2a9f, _0x3a049e)), _0x47603b = _0x3eb47f[_0x1d25d2(0x102)](_0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0x114)], 0x1e54 + 0x1eeb * 0x1 + -0x3 * 0x131d);
                function _0x2197fd() {
                    const _0x13c183 = _0x1d25d2;
                    return _0x3eb47f[_0x13c183(0xea)](__awaiter, this, void (-0xf65 + 0x2 * -0xf5e + -0x2e21 * -0x1), void (0x4d6 * 0x1 + 0x1af5 + -0x1fcb), function* () {
                        const _0x28a58c = _0x13c183;
                        yield _0x3eb47f[_0x28a58c(0xc1)](_0x20dc80, _0x47603b);
                    });
                }
                yield _0x3eb47f[_0x1d25d2(0xb0)](_0x2197fd);
            }
            if (_0x3eb47f[_0x1d25d2(0x87)](_0x124421[_0x1d25d2(0x11f)], _0x3eb47f[_0x1d25d2(0xfc)]) && _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0xfb)]) {
                const _0x3aa8c0 = _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0xfb)][_0x1d25d2(0xb2)]('/'), _0x396bbd = Object[_0x1d25d2(0xf0)](Object[_0x1d25d2(0xf0)]({}, _0x2ef01a), {
                        'body': _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0x100)],
                        'mediaUrl': _0x3aa8c0[_0x3eb47f[_0x1d25d2(0x10f)](_0x3aa8c0[_0x1d25d2(0x89)], 0x1a51 * -0x1 + -0x13fa * 0x1 + -0x4 * -0xb93)],
                        'mediaType': _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0x11f)] ? _0x3eb47f[_0x1d25d2(0xf1)](_0x195ad3 = _0x124421[_0x1d25d2(0x11a)], null) || _0x3eb47f[_0x1d25d2(0xd1)](_0x195ad3, void (-0x5f5 + 0x11b * -0xf + -0xb45 * -0x2)) ? void (-0x1b52 + -0x21e6 + -0x51a * -0xc) : _0x195ad3[_0x1d25d2(0x11f)][_0x1d25d2(0x128)](0x1e61 + 0xbd5 * -0x2 + -0x6b7, _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0x11f)][_0x1d25d2(0xe2)]('/')) : _0x3eb47f[_0x1d25d2(0x7f)]
                    }), _0x1bebc7 = yield Message_1[_0x1d25d2(0xa2)][_0x1d25d2(0xba)](_0x396bbd), _0x25f667 = {};
                _0x25f667[_0x1d25d2(0xb1)] = _0x3524fa;
                const _0x36be12 = {};
                _0x36be12[_0x1d25d2(0xf4)] = Ticket_1[_0x1d25d2(0xa2)], _0x36be12['as'] = _0x3eb47f[_0x1d25d2(0x124)], _0x36be12[_0x1d25d2(0x8b)] = _0x25f667, _0x36be12[_0x1d25d2(0x83)] = [_0x3eb47f[_0x1d25d2(0xd3)]];
                const _0x5d0ccf = yield Message_1[_0x1d25d2(0xa2)][_0x1d25d2(0xe6)](_0x1bebc7['id'], {
                    'include': [
                        _0x36be12,
                        {
                            'model': Message_1[_0x1d25d2(0xa2)],
                            'as': _0x3eb47f[_0x1d25d2(0xa6)],
                            'include': [_0x3eb47f[_0x1d25d2(0xd3)]]
                        }
                    ]
                });
                if (!_0x5d0ccf)
                    throw new Error(_0x3eb47f[_0x1d25d2(0xbf)]);
                yield _0x31498a[_0x1d25d2(0xd6)]({
                    'lastMessage': _0x5d0ccf[_0x1d25d2(0x8e)],
                    'lastMessageAt': new Date()[_0x1d25d2(0x11c)]()
                });
                const _0x43fb4f = {};
                _0x43fb4f[_0x1d25d2(0xb1)] = _0x3524fa, _0x43fb4f[_0x1d25d2(0x11f)] = _0x3eb47f[_0x1d25d2(0xac)], _0x43fb4f[_0x1d25d2(0xf2)] = _0x5d0ccf, (0xa4a + 0x283 * 0x3 + -0x11d3, socketEmit_1[_0x1d25d2(0xa2)])(_0x43fb4f);
            } else {
                if (_0x3eb47f[_0x1d25d2(0xe3)](_0x124421[_0x1d25d2(0x11f)], _0x3eb47f[_0x1d25d2(0xa8)]) && _0x3eb47f[_0x1d25d2(0x12b)](_0x124421[_0x1d25d2(0x11f)], _0x3eb47f[_0x1d25d2(0xfc)]) && _0x3eb47f[_0x1d25d2(0xe3)](_0x124421[_0x1d25d2(0x11f)], _0x3eb47f[_0x1d25d2(0xb5)]) && _0x3eb47f[_0x1d25d2(0xe3)](_0x124421[_0x1d25d2(0x11f)], _0x3eb47f[_0x1d25d2(0x8c)]) && _0x3eb47f[_0x1d25d2(0xe3)](_0x124421[_0x1d25d2(0x11f)], _0x3eb47f[_0x1d25d2(0xe9)])) {
                    _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0xa5)] = (-0x1838 + 0x38 * 0x58 + 0x4f8, pupa_1[_0x1d25d2(0x9c)])(_0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0xa5)] || '', {
                        'protocol': (_0x3eb47f[_0x1d25d2(0xd8)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0xd2)](_0x31498a, void (-0x7d4 + -0x14f3 + 0x35 * 0x8b)) ? void (0x1140 + 0x1065 + 0x9 * -0x3bd) : _0x31498a[_0x1d25d2(0xbb)]) || '',
                        'name': (_0x3eb47f[_0x1d25d2(0xfd)](_0x342aa1 = _0x3eb47f[_0x1d25d2(0x91)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0xbc)](_0x31498a, void (-0xc9d + -0x4f * 0x1a + 0x3 * 0x6e1)) ? void (-0xaf * 0x5 + 0x2079 + -0x1d0e) : _0x31498a[_0x1d25d2(0x11e)], null) || _0x3eb47f[_0x1d25d2(0xb8)](_0x342aa1, void (0x239a + 0x1c81 * 0x1 + -0x401b * 0x1)) ? void (0x151 * 0xa + 0x1 * 0x8bd + -0x15e7) : _0x342aa1[_0x1d25d2(0x100)]) || '',
                        'email': (_0x3eb47f[_0x1d25d2(0x10d)](_0x1ba35d = _0x3eb47f[_0x1d25d2(0x105)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0x10d)](_0x31498a, void (-0xd4 + -0x20 * -0x64 + -0xbac)) ? void (0xe2 * 0x1 + -0x20d3 + 0x1ff1) : _0x31498a[_0x1d25d2(0x11e)], null) || _0x3eb47f[_0x1d25d2(0x82)](_0x1ba35d, void (0x1825 + -0x225d + -0x4 * -0x28e)) ? void (-0x2617 + -0x1fa5 + 0x2 * 0x22de) : _0x1ba35d[_0x1d25d2(0xb3)]) || '',
                        'phoneNumber': (_0x3eb47f[_0x1d25d2(0xb6)](_0x1b2858 = _0x3eb47f[_0x1d25d2(0x90)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0xc3)](_0x31498a, void (0x56d + 0xeac + -0x3 * 0x6b3)) ? void (-0xb06 + 0xa2 + 0xa64) : _0x31498a[_0x1d25d2(0x11e)], null) || _0x3eb47f[_0x1d25d2(0xd2)](_0x1b2858, void (-0x3 * 0x621 + -0x1e * 0x95 + -0xbf3 * -0x3)) ? void (-0x16 * -0x14e + -0x253d + -0x5f * -0x17) : _0x1b2858[_0x1d25d2(0xa3)]) || '',
                        'kanban': (_0x3eb47f[_0x1d25d2(0xbe)](_0x4bde40 = _0x3eb47f[_0x1d25d2(0x11b)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0x10c)](_0x31498a, void (-0x26aa + 0x1bfe + 0xaac * 0x1)) ? void (0x9c6 + 0x1 * 0x1a52 + -0x2418) : _0x31498a[_0x1d25d2(0x11e)], null) || _0x3eb47f[_0x1d25d2(0x104)](_0x4bde40, void (-0x4 * -0x2c8 + -0x4a7 * 0x5 + -0x1 * -0xc23)) ? void (0x17e1 * -0x1 + -0x4 * 0x2f6 + 0x23b9) : _0x4bde40[_0x1d25d2(0x129)]) || '',
                        'user': (_0x3eb47f[_0x1d25d2(0x123)](_0x3ef715 = _0x3eb47f[_0x1d25d2(0xb6)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0xf1)](_0x31498a, void (0x49 * 0x5f + 0x1d9d + 0x13 * -0x2fc)) ? void (-0xcfc + -0x21a * -0x8 + -0x3d4) : _0x31498a[_0x1d25d2(0x101)], null) || _0x3eb47f[_0x1d25d2(0xdc)](_0x3ef715, void (-0x1b69 + -0x54 * -0x1e + 0x1191)) ? void (0x1eb + 0x172c + -0x1917) : _0x3ef715[_0x1d25d2(0x100)]) || '',
                        'userEmail': (_0x3eb47f[_0x1d25d2(0xd8)](_0x5c812b = _0x3eb47f[_0x1d25d2(0x87)](_0x31498a, null) || _0x3eb47f[_0x1d25d2(0xe4)](_0x31498a, void (0xaf6 + -0xd9 * -0xd + 0x14b * -0x11)) ? void (0x1a14 + 0x1 * -0x969 + -0x10ab) : _0x31498a[_0x1d25d2(0x101)], null) || _0x3eb47f[_0x1d25d2(0x9f)](_0x5c812b, void (0x1 * -0x8d5 + -0x2d9 + 0xe6 * 0xd)) ? void (-0x6 * -0x3fb + 0x1 * -0x32b + -0x1 * 0x14b7) : _0x5c812b[_0x1d25d2(0xb3)]) || ''
                    });
                    const _0x5e6579 = {};
                    _0x5e6579[_0x1d25d2(0x8e)] = _0x124421[_0x1d25d2(0x11a)][_0x1d25d2(0xa5)], _0x5e6579[_0x1d25d2(0xe5)] = _0x3eb47f[_0x1d25d2(0x7f)];
                    const _0x2708ce = yield Message_1[_0x1d25d2(0xa2)][_0x1d25d2(0xba)](Object[_0x1d25d2(0xf0)](Object[_0x1d25d2(0xf0)]({}, _0x2ef01a), _0x5e6579)), _0x2ac8af = {};
                    _0x2ac8af[_0x1d25d2(0xb1)] = _0x3524fa;
                    const _0x310169 = {};
                    _0x310169[_0x1d25d2(0xf4)] = Ticket_1[_0x1d25d2(0xa2)], _0x310169['as'] = _0x3eb47f[_0x1d25d2(0x124)], _0x310169[_0x1d25d2(0x8b)] = _0x2ac8af, _0x310169[_0x1d25d2(0x83)] = [_0x3eb47f[_0x1d25d2(0xd3)]];
                    const _0x1981da = yield Message_1[_0x1d25d2(0xa2)][_0x1d25d2(0xe6)](_0x2708ce['id'], {
                        'include': [
                            _0x310169,
                            {
                                'model': Message_1[_0x1d25d2(0xa2)],
                                'as': _0x3eb47f[_0x1d25d2(0xa6)],
                                'include': [_0x3eb47f[_0x1d25d2(0xd3)]]
                            }
                        ]
                    });
                    if (!_0x1981da)
                        throw new Error(_0x3eb47f[_0x1d25d2(0xbf)]);
                    yield _0x31498a[_0x1d25d2(0xd6)]({
                        'lastMessage': _0x1981da[_0x1d25d2(0x8e)],
                        'lastMessageAt': new Date()[_0x1d25d2(0x11c)](),
                        'answered': !![]
                    });
                    const _0x5e368d = {};
                    _0x5e368d[_0x1d25d2(0xb1)] = _0x3524fa, _0x5e368d[_0x1d25d2(0x11f)] = _0x3eb47f[_0x1d25d2(0xac)], _0x5e368d[_0x1d25d2(0xf2)] = _0x1981da, (0x1e70 + -0xda8 + -0x18 * 0xb3, socketEmit_1[_0x1d25d2(0xa2)])(_0x5e368d);
                }
            }
        } catch (_0x3047a7) {
            logger_1[_0x1d25d2(0x84)][_0x1d25d2(0xde)](_0x3eb47f[_0x1d25d2(0xaf)], _0x3047a7);
        }
    });
exports[_0x5dd430(0xa2)] = BuildSendMessageService;
function _0x1a90() {
    const _0x32de8e = [
        'essageServ',
        '1816QJjKEZ',
        'string',
        'Tzzfj',
        'ers/socket',
        'pupa',
        'HJfOV',
        '3269HgyXKk',
        'ntpOm',
        's/pupa',
        'axios',
        'default',
        'number',
        'ate',
        'message',
        'ZnLMt',
        'pcYfE',
        'QdBBL',
        'then',
        'CXQEm',
        'qMTQN',
        'OqXUd',
        's/logger',
        'get',
        'cHWmH',
        'TbTTw',
        'tenantId',
        'split',
        'email',
        'ervice',
        'eeNio',
        'WWfWL',
        'chatFlowId',
        'VrygK',
        'goOdV',
        'create',
        'protocol',
        'NoFvP',
        '10573690QUTnQE',
        'zJQiZ',
        'ZbLVJ',
        '1431EXrSGA',
        'MFbsU',
        'toString',
        'jSprW',
        'ticket',
        'aGxJG',
        'value',
        'MediaField',
        'chat',
        'WebhookFie',
        'XNrBF',
        'DelayField',
        '5FBMlyc',
        'done',
        'ERR_CREATI',
        'YWdyB',
        'fault',
        'OlTLc',
        'dxenh',
        'dkqWa',
        'tag',
        'mOCkW',
        'update',
        'apply',
        'uqYnI',
        'anEte',
        'pdateConta',
        '__awaiter',
        'yNlIR',
        'Emit',
        'error',
        'UNjuF',
        'bot',
        '__esModule',
        'indexOf',
        'cQlzO',
        'dzdYi',
        'mediaType',
        'findByPk',
        'nRjMH',
        'owTicketSe',
        'clyTz',
        'KGREt',
        'fromMe',
        'quotedMsg',
        'ctTagsBotS',
        '../TicketS',
        'ChatFlowFi',
        'assign',
        'WcCGZ',
        'payload',
        'pending',
        'model',
        'contactId',
        'ls/Message',
        'firstCall',
        'yTfwS',
        'BuildSendM',
        '__importDe',
        'mediaUrl',
        'cwIjO',
        'xNJiB',
        'Services/U',
        'chatFlow',
        'name',
        'user',
        'qKXHh',
        'ervices/Sh',
        'IyVbT',
        'QUMej',
        'rvice',
        'gvHsb',
        'epsChatFlo',
        'DBFEP',
        'bPYjz',
        '1890534HbtVWP',
        'jLLvf',
        'JTVjo',
        '../../help',
        'CjyAz',
        'erty',
        'defineProp',
        'ticket:upd',
        'throw',
        'time',
        '../../mode',
        'TagField',
        'stepChatFl',
        'eld',
        'next',
        'data',
        'gcdxe',
        'getTime',
        'sMndb',
        'contact',
        'type',
        '99136IZRBIC',
        'ice',
        '_SYSTEM',
        'YpZhj',
        'fJwVn',
        '2656ZAdzwA',
        'webhook',
        'nodeC',
        'substr',
        'kanban',
        '508470ayxthe',
        'BWFQb',
        'bdmfX',
        'bZImM',
        'vopvP',
        '../../util',
        'ls/Ticket',
        'MEpdL',
        'include',
        'logger',
        'NG_MESSAGE',
        'lastMessag',
        'qmpHU',
        '../Contact',
        'length',
        '2689623bXQxQE',
        'where',
        'ftApP',
        'chat:creat',
        'body',
        'wTicket',
        'hkdkp',
        'nSYUN',
        './VerifySt',
        'nhDDN',
        'kFsST',
        'VLVzx',
        'answered'
    ];
    _0x1a90 = function () {
        return _0x32de8e;
    };
    return _0x1a90();
}