'use strict';
const _0x2fd2e9 = _0x2a3f;
(function (_0x521b97, _0x59d7a9) {
    const _0x471cbb = _0x2a3f, _0x296592 = _0x521b97();
    while (!![]) {
        try {
            const _0x2ca1dc = -parseInt(_0x471cbb(0xa1)) / (-0xbc5 + 0x3d * 0x66 + -0xc88) * (parseInt(_0x471cbb(0xe0)) / (0x2635 + 0x3 * 0x5d7 + 0x6f7 * -0x8)) + -parseInt(_0x471cbb(0x85)) / (-0x115 * 0x3 + -0x82b + -0x1 * -0xb6d) * (parseInt(_0x471cbb(0xab)) / (-0x21b2 + -0x2 * 0x8bf + 0x3334 * 0x1)) + parseInt(_0x471cbb(0xb4)) / (-0x1f * 0x19 + 0x11a * 0x21 + 0x2a * -0xcb) + -parseInt(_0x471cbb(0x8a)) / (0x1d42 + -0x1750 + -0x5ec) + parseInt(_0x471cbb(0xcb)) / (-0x1dbd * -0x1 + -0x3f5 * -0x5 + -0x317f * 0x1) + -parseInt(_0x471cbb(0xc4)) / (0x107d + 0x1174 + -0x21e9) * (-parseInt(_0x471cbb(0xcd)) / (0x6b * 0x13 + 0x95 * 0x14 + -0x138c)) + parseInt(_0x471cbb(0xa6)) / (-0x1 * -0x1f43 + 0x3 * 0x6d9 + 0x2 * -0x19e2);
            if (_0x2ca1dc === _0x59d7a9)
                break;
            else
                _0x296592['push'](_0x296592['shift']());
        } catch (_0x2b46b2) {
            _0x296592['push'](_0x296592['shift']());
        }
    }
}(_0x5bd3, -0x49 * 0x2f17 + -0x69c38 * 0x2 + 0x2197ad));
var __awaiter = this && this[_0x2fd2e9(0xdb)] || function (_0x1761b4, _0x27e8ba, _0x497fd1, _0x26ff43) {
        const _0x2f853a = _0x2fd2e9, _0x3f0b7c = {
                'mSZML': function (_0x398a6f, _0x4d3dcd) {
                    return _0x398a6f(_0x4d3dcd);
                },
                'JSBMI': function (_0x3c429f, _0x4260c9) {
                    return _0x3c429f instanceof _0x4260c9;
                },
                'mEQhc': function (_0x40c71c, _0x495230) {
                    return _0x40c71c(_0x495230);
                },
                'Dmrip': function (_0x37a5d0, _0x2b8022) {
                    return _0x37a5d0(_0x2b8022);
                },
                'IvVia': function (_0x312b34, _0x5dd25e) {
                    return _0x312b34(_0x5dd25e);
                },
                'VJjou': _0x2f853a(0xaf),
                'ZBzWB': function (_0x4042fd, _0x3785b8) {
                    return _0x4042fd(_0x3785b8);
                }
            };
        function _0x4dbf96(_0x1949ba) {
            const _0x141635 = _0x2f853a, _0x136365 = {
                    'hmMca': function (_0x58726a, _0x24673d) {
                        const _0x1eb309 = _0x2a3f;
                        return _0x3f0b7c[_0x1eb309(0xbc)](_0x58726a, _0x24673d);
                    }
                };
            return _0x3f0b7c[_0x141635(0xdd)](_0x1949ba, _0x497fd1) ? _0x1949ba : new _0x497fd1(function (_0x16e583) {
                const _0x444de9 = _0x141635;
                _0x136365[_0x444de9(0x87)](_0x16e583, _0x1949ba);
            });
        }
        return new (_0x497fd1 || (_0x497fd1 = Promise))(function (_0x2aec83, _0x35b978) {
            const _0x39f9ff = _0x2f853a, _0x1cc78e = {
                    'MVabz': function (_0x38a396, _0xc6a55d) {
                        const _0x27fdbf = _0x2a3f;
                        return _0x3f0b7c[_0x27fdbf(0xe6)](_0x38a396, _0xc6a55d);
                    },
                    'BfZrh': function (_0x54726e, _0xc10017) {
                        const _0x688aaa = _0x2a3f;
                        return _0x3f0b7c[_0x688aaa(0x82)](_0x54726e, _0xc10017);
                    },
                    'IzzVd': function (_0x416126, _0xceabc9) {
                        const _0x11acd4 = _0x2a3f;
                        return _0x3f0b7c[_0x11acd4(0xbc)](_0x416126, _0xceabc9);
                    },
                    'irNlf': _0x3f0b7c[_0x39f9ff(0xc0)],
                    'NIzaq': function (_0x31d057, _0x5f51b8) {
                        const _0x492c44 = _0x39f9ff;
                        return _0x3f0b7c[_0x492c44(0xbb)](_0x31d057, _0x5f51b8);
                    }
                };
            function _0x2f02e1(_0x590a8c) {
                const _0x5d6f3c = _0x39f9ff;
                try {
                    _0x1cc78e[_0x5d6f3c(0xbd)](_0x1d92bc, _0x26ff43[_0x5d6f3c(0xe8)](_0x590a8c));
                } catch (_0x5cb895) {
                    _0x1cc78e[_0x5d6f3c(0x99)](_0x35b978, _0x5cb895);
                }
            }
            function _0x4c07d4(_0x52ae97) {
                const _0x560ad6 = _0x39f9ff;
                try {
                    _0x1cc78e[_0x560ad6(0x88)](_0x1d92bc, _0x26ff43[_0x1cc78e[_0x560ad6(0xc8)]](_0x52ae97));
                } catch (_0x483182) {
                    _0x1cc78e[_0x560ad6(0xd3)](_0x35b978, _0x483182);
                }
            }
            function _0x1d92bc(_0x5afa00) {
                const _0x4e3192 = _0x39f9ff;
                _0x5afa00[_0x4e3192(0xe7)] ? _0x3f0b7c[_0x4e3192(0xaa)](_0x2aec83, _0x5afa00[_0x4e3192(0xde)]) : _0x3f0b7c[_0x4e3192(0xaa)](_0x4dbf96, _0x5afa00[_0x4e3192(0xde)])[_0x4e3192(0x89)](_0x2f02e1, _0x4c07d4);
            }
            _0x3f0b7c[_0x39f9ff(0x82)](_0x1d92bc, (_0x26ff43 = _0x26ff43[_0x39f9ff(0xc6)](_0x1761b4, _0x27e8ba || []))[_0x39f9ff(0xe8)]());
        });
    }, __importDefault = this && this[_0x2fd2e9(0xb0) + _0x2fd2e9(0x95)] || function (_0x15133d) {
        const _0x5c5385 = _0x2fd2e9;
        return _0x15133d && _0x15133d[_0x5c5385(0xc3)] ? _0x15133d : { 'default': _0x15133d };
    };
function _0x2a3f(_0x3fa13f, _0x314ee8) {
    const _0x30649e = _0x5bd3();
    return _0x2a3f = function (_0xb02563, _0x1cae95) {
        _0xb02563 = _0xb02563 - (-0x1 * -0x1ea1 + -0x21d6 + 0x3 * 0x13d);
        let _0x71046d = _0x30649e[_0xb02563];
        return _0x71046d;
    }, _0x2a3f(_0x3fa13f, _0x314ee8);
}
function _0x5bd3() {
    const _0x8679b1 = [
        '93160OAynvv',
        'Send\x20error',
        'apply',
        'url',
        'irNlf',
        'getTime',
        'ack',
        '1524033GdUGqj',
        'access_tok',
        '333PyXOzr',
        'PWXia',
        'n/json',
        'ls/Ticket',
        'jXXEL',
        'rs/AppErro',
        'NIzaq',
        'status',
        'CONNECTED',
        'data',
        'en=',
        'uWUjR',
        'Content-Ty',
        'ate',
        '__awaiter',
        'ticket:upd',
        'JSBMI',
        'value',
        'tenantId',
        '302598oxflFY',
        '../../help',
        'ok.com/v19',
        'PP_OFFLINE',
        'sended',
        'ANuJs',
        'Dmrip',
        'done',
        'next',
        'EnuPj',
        'type',
        'axios',
        'IvVia',
        'ERR_WHATSA',
        'POST',
        '597UaDrQI',
        'contact',
        'hmMca',
        'IzzVd',
        'then',
        '3966900IrQPOa',
        'erty',
        'RTULu',
        'messageId',
        'payload',
        'chat:ack',
        'ers/socket',
        'body',
        'ikxsk',
        'product',
        'khuTm',
        'fault',
        'headers',
        'findOne',
        'GsPsL',
        'BfZrh',
        'wrman',
        'messages',
        'update',
        'applicatio',
        'text',
        '/messages?',
        'ls/Message',
        '3pIDQJp',
        'aph.facebo',
        'messaging_',
        'error',
        'default',
        '13894000OLRkMM',
        'whatsapp',
        'defineProp',
        'sendMessag',
        'mEQhc',
        '17400MjJTyn',
        'fromMe',
        'xwYcD',
        'jpkUu',
        'throw',
        '__importDe',
        'Emit',
        'nnxCJ',
        '../../mode',
        '1988995rXtUCU',
        'where',
        'idFront',
        'now',
        'https://gr',
        'bmToken',
        'Tegtt',
        'ZBzWB',
        'mSZML',
        'MVabz',
        'method',
        '../../erro',
        'VJjou',
        '.0/',
        'JjAuB',
        '__esModule'
    ];
    _0x5bd3 = function () {
        return _0x8679b1;
    };
    return _0x5bd3();
}
const _0x2a1a3f = {};
_0x2a1a3f[_0x2fd2e9(0xde)] = !![], Object[_0x2fd2e9(0xa8) + _0x2fd2e9(0x8b)](exports, _0x2fd2e9(0xc3), _0x2a1a3f);
const axios_1 = __importDefault(require(_0x2fd2e9(0xeb))), Ticket_1 = __importDefault(require(_0x2fd2e9(0xb3) + _0x2fd2e9(0xd0))), Message_1 = __importDefault(require(_0x2fd2e9(0xb3) + _0x2fd2e9(0xa0))), socketEmit_1 = __importDefault(require(_0x2fd2e9(0xe1) + _0x2fd2e9(0x90) + _0x2fd2e9(0xb1))), AppError_1 = __importDefault(require(_0x2fd2e9(0xbf) + _0x2fd2e9(0xd2) + 'r'));
class SendMessage {
    [_0x2fd2e9(0xa9) + 'e']({
        from: _0x4622f3,
        phone_number_id: _0x2a16a5,
        message: _0x108c37,
        ticket: _0x101a61,
        tenantId: _0x21c541,
        idFront: _0x51302c,
        whatsapp: _0x5da688
    }) {
        const _0x3c0ba6 = _0x2fd2e9, _0x2e4ab8 = {
                'wrman': function (_0x37c39e, _0x595886) {
                    return _0x37c39e !== _0x595886;
                },
                'ikxsk': _0x3c0ba6(0xd5),
                'GsPsL': _0x3c0ba6(0x83) + _0x3c0ba6(0xe3),
                'Tegtt': function (_0x283c6f, _0x1af1fe) {
                    return _0x283c6f === _0x1af1fe;
                },
                'PWXia': function (_0x2f7197, _0x524299) {
                    return _0x2f7197 === _0x524299;
                },
                'jpkUu': _0x3c0ba6(0x84),
                'RTULu': _0x3c0ba6(0xa7),
                'ANuJs': _0x3c0ba6(0x9d) + _0x3c0ba6(0xcf),
                'khuTm': function (_0x3c0884, _0x2062fd) {
                    return _0x3c0884 || _0x2062fd;
                },
                'nnxCJ': _0x3c0ba6(0x9e),
                'JjAuB': _0x3c0ba6(0xe4),
                'EnuPj': _0x3c0ba6(0xdc) + _0x3c0ba6(0xda),
                'jXXEL': _0x3c0ba6(0x8f),
                'xwYcD': _0x3c0ba6(0xc5) + ':',
                'uWUjR': function (_0x423faa, _0x4d779b, _0x2f4888, _0x4e461f, _0xae456d) {
                    return _0x423faa(_0x4d779b, _0x2f4888, _0x4e461f, _0xae456d);
                }
            };
        return _0x2e4ab8[_0x3c0ba6(0xd8)](__awaiter, this, void (0x122a + -0x23 * -0x74 + -0x2206), void (0xfde + -0x1674 + 0x3 * 0x232), function* () {
            const _0x55990a = _0x3c0ba6;
            if (_0x2e4ab8[_0x55990a(0x9a)](_0x5da688[_0x55990a(0xd4)], _0x2e4ab8[_0x55990a(0x92)]))
                throw new AppError_1[(_0x55990a(0xa5))](_0x2e4ab8[_0x55990a(0x98)], 0x2666 + 0x1 * -0xcef + -0x17e7);
            try {
                const _0x23674d = _0x55990a(0xb8) + _0x55990a(0xa2) + _0x55990a(0xe2) + _0x55990a(0xc1) + _0x2a16a5 + (_0x55990a(0x9f) + _0x55990a(0xcc) + _0x55990a(0xd7)) + (_0x2e4ab8[_0x55990a(0xba)](_0x5da688, null) || _0x2e4ab8[_0x55990a(0xce)](_0x5da688, void (0x73b + -0x18be * 0x1 + 0x1 * 0x1183)) ? void (-0x2115 + 0x1453 + 0x2 * 0x661) : _0x5da688[_0x55990a(0xb9)]), _0x42e078 = {};
                _0x42e078[_0x55990a(0x91)] = _0x108c37;
                const _0x3357e5 = {};
                _0x3357e5[_0x55990a(0xbe)] = _0x2e4ab8[_0x55990a(0xae)], _0x3357e5[_0x55990a(0xc7)] = _0x23674d, _0x3357e5[_0x55990a(0xd6)] = {}, _0x3357e5[_0x55990a(0x96)] = {}, _0x3357e5[_0x55990a(0xd6)][_0x55990a(0xa3) + _0x55990a(0x93)] = _0x2e4ab8[_0x55990a(0x8c)], _0x3357e5[_0x55990a(0xd6)]['to'] = _0x4622f3, _0x3357e5[_0x55990a(0xd6)][_0x55990a(0x9e)] = _0x42e078, _0x3357e5[_0x55990a(0x96)][_0x55990a(0xd9) + 'pe'] = _0x2e4ab8[_0x55990a(0xe5)];
                const _0x9064c6 = yield (-0x69b + -0x7f4 + 0xe8f, axios_1[_0x55990a(0xa5)])(_0x3357e5);
                let _0xff9ac4 = Date[_0x55990a(0xb7)]();
                const _0x927121 = {
                        'messageId': _0x9064c6[_0x55990a(0xd6)][_0x55990a(0x9b)][0x1a2a + -0x236c + 0x4a1 * 0x2]['id'] || '',
                        'ticketId': _0x101a61['id'],
                        'contactId': _0x101a61[_0x55990a(0x86)]['id'],
                        'body': _0x2e4ab8[_0x55990a(0x94)](_0x108c37, ''),
                        'fromMe': !![],
                        'mediaType': _0x2e4ab8[_0x55990a(0xb2)],
                        'read': !![],
                        'ack': 0x2,
                        'timestamp': _0xff9ac4,
                        'status': _0x2e4ab8[_0x55990a(0xc2)]
                    }, _0x3b4e1e = {};
                _0x3b4e1e['id'] = _0x101a61['id'];
                const _0x2fb96d = {};
                _0x2fb96d[_0x55990a(0xb5)] = _0x3b4e1e;
                const _0x1752f2 = yield Ticket_1[_0x55990a(0xa5)][_0x55990a(0x97)](_0x2fb96d);
                if (!_0x1752f2)
                    return;
                yield _0x1752f2[_0x55990a(0x9c)]({
                    'lastMessage': _0x927121[_0x55990a(0x91)],
                    'lastMessageAt': new Date()[_0x55990a(0xc9)](),
                    'answered': _0x9064c6[_0x55990a(0xd6)][_0x55990a(0xac)] || ![]
                });
                const _0x2ab3e2 = {};
                _0x2ab3e2[_0x55990a(0xb6)] = _0x51302c, _0x2ab3e2[_0x55990a(0xdf)] = _0x21c541;
                const _0x1095bc = {};
                _0x1095bc[_0x55990a(0xb5)] = _0x2ab3e2;
                const _0x4d15fb = yield Message_1[_0x55990a(0xa5)][_0x55990a(0x97)](_0x1095bc);
                if (!_0x4d15fb)
                    return;
                const _0x30061a = {};
                _0x30061a[_0x55990a(0x8d)] = _0x9064c6[_0x55990a(0xd6)][_0x55990a(0x9b)][0x4f0 * 0x5 + -0x5 * 0x417 + 0xd9 * -0x5]['id'], _0x30061a[_0x55990a(0xca)] = 0x2, _0x30061a[_0x55990a(0xd4)] = _0x2e4ab8[_0x55990a(0xc2)], yield _0x4d15fb[_0x55990a(0x9c)](_0x30061a);
                const _0x2ac87a = {};
                _0x2ac87a[_0x55990a(0xdf)] = _0x21c541, _0x2ac87a[_0x55990a(0xea)] = _0x2e4ab8[_0x55990a(0xe9)], _0x2ac87a[_0x55990a(0x8e)] = _0x101a61, (-0xa09 + 0x2280 + -0x1877, socketEmit_1[_0x55990a(0xa5)])(_0x2ac87a);
                const _0x57dbbb = {};
                _0x57dbbb[_0x55990a(0x8d)] = _0x9064c6[_0x55990a(0xd6)][_0x55990a(0x9b)][-0x465 + 0x1d65 * -0x1 + 0x21ca]['id'], _0x57dbbb[_0x55990a(0xdf)] = _0x21c541;
                const _0x26d9d7 = {};
                _0x26d9d7[_0x55990a(0xb5)] = _0x57dbbb;
                const _0x4a995f = yield Message_1[_0x55990a(0xa5)][_0x55990a(0x97)](_0x26d9d7);
                if (!_0x4a995f)
                    return;
                const _0xa3856 = {};
                return _0xa3856[_0x55990a(0xdf)] = _0x21c541, _0xa3856[_0x55990a(0xea)] = _0x2e4ab8[_0x55990a(0xd1)], _0xa3856[_0x55990a(0x8e)] = _0x4a995f, (0x31a * -0x4 + 0x299 + 0x9cf, socketEmit_1[_0x55990a(0xa5)])(_0xa3856), _0x9064c6[_0x55990a(0xd6)];
            } catch (_0x48729a) {
                console[_0x55990a(0xa4)](_0x2e4ab8[_0x55990a(0xad)], _0x48729a);
                throw _0x48729a;
            }
        });
    }
}
exports[_0x2fd2e9(0xa5)] = SendMessage;