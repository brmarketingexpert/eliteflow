'use strict';
const _0x20ebbd = _0xb51b;
function _0xb51b(_0x5a364d, _0x3ed59e) {
    const _0x1c1d91 = _0x1eeb();
    return _0xb51b = function (_0x1df2d2, _0x547b55) {
        _0x1df2d2 = _0x1df2d2 - (0x118e + 0x20be + 0x18ac * -0x2);
        let _0x5bfe53 = _0x1c1d91[_0x1df2d2];
        return _0x5bfe53;
    }, _0xb51b(_0x5a364d, _0x3ed59e);
}
(function (_0x30c566, _0x582a0f) {
    const _0x2f9aa3 = _0xb51b, _0x1a0377 = _0x30c566();
    while (!![]) {
        try {
            const _0x1e6d16 = parseInt(_0x2f9aa3(0x18a)) / (0x1731 + -0x359 * -0x1 + 0x1 * -0x1a89) + -parseInt(_0x2f9aa3(0x152)) / (-0x2f * 0x8b + -0x1861 * 0x1 + 0xc7a * 0x4) + parseInt(_0x2f9aa3(0x177)) / (0x56 * 0x2 + -0x137 * -0x8 + 0x1 * -0xa61) * (-parseInt(_0x2f9aa3(0x139)) / (-0xf2 * -0x6 + 0xea * -0x18 + -0x8 * -0x209)) + parseInt(_0x2f9aa3(0x143)) / (0x1 * 0x214b + -0x1 * 0x1285 + -0x3 * 0x4eb) + parseInt(_0x2f9aa3(0x135)) / (-0x142f + 0x22b6 + -0xe81) * (parseInt(_0x2f9aa3(0x14d)) / (0x877 * 0x3 + -0x20b9 + 0x75b)) + parseInt(_0x2f9aa3(0x137)) / (-0x1865 + -0x246 + 0x5 * 0x557) * (-parseInt(_0x2f9aa3(0x108)) / (0x2103 + -0xbf * -0x27 + -0x3e13)) + parseInt(_0x2f9aa3(0x17f)) / (0x257 * 0x7 + -0xa86 * -0x1 + -0x1add) * (-parseInt(_0x2f9aa3(0x164)) / (0x1 * 0x3d1 + 0x1182 + -0x1548));
            if (_0x1e6d16 === _0x582a0f)
                break;
            else
                _0x1a0377['push'](_0x1a0377['shift']());
        } catch (_0x4b8176) {
            _0x1a0377['push'](_0x1a0377['shift']());
        }
    }
}(_0x1eeb, 0x3e403 * 0x2 + 0xb741 + 0x100b * -0x46));
var __awaiter = this && this[_0x20ebbd(0x140)] || function (_0x468e4b, _0x3a0235, _0x311bac, _0x367a42) {
        const _0x3a0485 = _0x20ebbd, _0x457dba = {
                'sHqJl': function (_0x1bb840, _0x35c714) {
                    return _0x1bb840(_0x35c714);
                },
                'QJHYy': function (_0x2a2467, _0x3d34e3) {
                    return _0x2a2467 instanceof _0x3d34e3;
                },
                'bzjmU': function (_0x28cc88, _0xe7d7d4) {
                    return _0x28cc88(_0xe7d7d4);
                },
                'WILPB': _0x3a0485(0x191),
                'IsvCK': function (_0x3fdc6b, _0x5d4cb4) {
                    return _0x3fdc6b(_0x5d4cb4);
                },
                'yhcjQ': function (_0x4af717, _0x286496) {
                    return _0x4af717(_0x286496);
                },
                'rwgsb': function (_0x518e19, _0x5670ad) {
                    return _0x518e19(_0x5670ad);
                }
            };
        function _0x1e0745(_0x5aa383) {
            const _0x5ac71d = _0x3a0485;
            return _0x457dba[_0x5ac71d(0x182)](_0x5aa383, _0x311bac) ? _0x5aa383 : new _0x311bac(function (_0x4b40ec) {
                const _0x42c6f0 = _0x5ac71d;
                _0x457dba[_0x42c6f0(0x103)](_0x4b40ec, _0x5aa383);
            });
        }
        return new (_0x311bac || (_0x311bac = Promise))(function (_0x5f4806, _0x365ede) {
            const _0x727ab4 = _0x3a0485, _0x28e888 = {
                    'qqjNi': function (_0x42e9f, _0x331135) {
                        const _0x34c9ae = _0xb51b;
                        return _0x457dba[_0x34c9ae(0x18d)](_0x42e9f, _0x331135);
                    },
                    'IHxbT': function (_0x418afb, _0x323d8c) {
                        const _0x2d820e = _0xb51b;
                        return _0x457dba[_0x2d820e(0x10a)](_0x418afb, _0x323d8c);
                    }
                };
            function _0x5a530b(_0x1727d6) {
                const _0x18a008 = _0xb51b;
                try {
                    _0x28e888[_0x18a008(0xfb)](_0x1dc65d, _0x367a42[_0x18a008(0x145)](_0x1727d6));
                } catch (_0x4fcc7d) {
                    _0x28e888[_0x18a008(0x111)](_0x365ede, _0x4fcc7d);
                }
            }
            function _0x109924(_0x5437a7) {
                const _0x1b97d8 = _0xb51b;
                try {
                    _0x457dba[_0x1b97d8(0x134)](_0x1dc65d, _0x367a42[_0x457dba[_0x1b97d8(0x157)]](_0x5437a7));
                } catch (_0x2cb2f8) {
                    _0x457dba[_0x1b97d8(0x10b)](_0x365ede, _0x2cb2f8);
                }
            }
            function _0x1dc65d(_0x395699) {
                const _0x35a36b = _0xb51b;
                _0x395699[_0x35a36b(0x136)] ? _0x457dba[_0x35a36b(0x103)](_0x5f4806, _0x395699[_0x35a36b(0x158)]) : _0x457dba[_0x35a36b(0x134)](_0x1e0745, _0x395699[_0x35a36b(0x158)])[_0x35a36b(0x11c)](_0x5a530b, _0x109924);
            }
            _0x457dba[_0x727ab4(0x10b)](_0x1dc65d, (_0x367a42 = _0x367a42[_0x727ab4(0x129)](_0x468e4b, _0x3a0235 || []))[_0x727ab4(0x145)]());
        });
    }, __importDefault = this && this[_0x20ebbd(0xfe) + _0x20ebbd(0x167)] || function (_0x3b3bfd) {
        const _0x16e8e9 = _0x20ebbd;
        return _0x3b3bfd && _0x3b3bfd[_0x16e8e9(0x149)] ? _0x3b3bfd : { 'default': _0x3b3bfd };
    };
const _0x56b7e0 = {};
function _0x1eeb() {
    const _0x33e695 = [
        'include',
        '1562665NeZQLT',
        'wpfYP',
        'next',
        'ack',
        'data',
        'default',
        '__esModule',
        'status',
        'headers',
        'eUyID',
        '105GwUwDS',
        'NG_MESSAGE',
        'API',
        'ls/Message',
        'externalKe',
        '176378lakufA',
        'all',
        'CExCH',
        'add',
        'response',
        'WILPB',
        'value',
        'uuid',
        'EjHpQ',
        'QdkpY',
        'user',
        'defineProp',
        's/pupa',
        'create',
        'stream',
        '/Queue',
        'ZxDdB',
        'quotedMsg',
        '3108193VmjAHE',
        'path',
        'mediaUrl',
        'fault',
        '../../help',
        'mediaType',
        'ticket',
        '_SYSTEM',
        'eketw',
        'bUtgh',
        'messageId',
        'erty',
        'mime',
        'axios',
        'assign',
        'tenantId',
        'hrItA',
        'FCvIg',
        'XnAeG',
        '3Xyrdqu',
        'ageSystemS',
        'originalna',
        'responseTy',
        'Chhsx',
        'chat:creat',
        'VAyIu',
        'NSvWD',
        '10MOznHY',
        'LOAD',
        'CJkZX',
        'QJHYy',
        'findByPk',
        'contact',
        'EuHim',
        'join',
        'ervice',
        'VRHSE',
        'number',
        '479570UMDxDB',
        'eStream',
        'name',
        'yhcjQ',
        'update',
        'TYVft',
        'getTime',
        'throw',
        'Iocmi',
        'urlMessage',
        'pupa',
        'body',
        'ioLGJ',
        'payload',
        'wUWsR',
        'apiConfig',
        '../../util',
        'lJnju',
        'qqjNi',
        'contactId',
        'model',
        '__importDe',
        'split',
        's/logger',
        'aKAze',
        'push',
        'sHqJl',
        'extension',
        'ls/Ticket',
        'pipe',
        'content-ty',
        '9xAVvUw',
        'media',
        'rwgsb',
        'IsvCK',
        'type',
        'fromMe',
        'authToken',
        'ShzXF',
        'WebHooksAP',
        'IHxbT',
        'sCUcJ',
        'protocol',
        'substr',
        'ers/socket',
        'get',
        'ERROR\x20DONW',
        'rmdirSync',
        'recursive',
        'logger',
        'CreateMess',
        'then',
        'eStatus',
        'PVRNs',
        'map',
        'EeBSy',
        'kanban',
        'hookMessag',
        'indexOf',
        'url',
        'notes',
        'OyQuf',
        'message',
        'wecjT',
        'apply',
        'public',
        'Emit',
        'chat',
        'where',
        'RfvHW',
        'filename',
        'email',
        'JwLky',
        'bOSIb',
        'Status',
        'bzjmU',
        '125670NrRDaG',
        'done',
        '2424184eiIODl',
        'finish',
        '652488jJnxWb',
        '../../libs',
        '../../mode',
        'error',
        'mimetype',
        'createWrit',
        'ERR_CREATI',
        '__awaiter',
        'JANFK'
    ];
    _0x1eeb = function () {
        return _0x33e695;
    };
    return _0x1eeb();
}
_0x56b7e0[_0x20ebbd(0x158)] = !![], Object[_0x20ebbd(0x15d) + _0x20ebbd(0x16f)](exports, _0x20ebbd(0x149), _0x56b7e0);
const fs_1 = __importDefault(require('fs')), path_1 = require(_0x20ebbd(0x165)), axios_1 = __importDefault(require(_0x20ebbd(0x171))), mime_1 = __importDefault(require(_0x20ebbd(0x170))), uuid_1 = require(_0x20ebbd(0x159)), logger_1 = require(_0x20ebbd(0xf9) + _0x20ebbd(0x100)), Ticket_1 = __importDefault(require(_0x20ebbd(0x13b) + _0x20ebbd(0x105))), Message_1 = __importDefault(require(_0x20ebbd(0x13b) + _0x20ebbd(0x150))), socketEmit_1 = __importDefault(require(_0x20ebbd(0x168) + _0x20ebbd(0x115) + _0x20ebbd(0x12b))), Queue_1 = __importDefault(require(_0x20ebbd(0x13a) + _0x20ebbd(0x161))), pupa_1 = require(_0x20ebbd(0xf9) + _0x20ebbd(0x15e)), downloadMedia = _0x24cedb => __awaiter(void (-0x6 * 0x281 + 0x12b9 + 0x3b3 * -0x1), void (-0xb1 * 0xf + 0x5b7 + 0x4a8), void (0xa7 * -0xb + -0xe57 + 0x1584), function* () {
        const _0x4ab957 = _0x20ebbd, _0xcd4e4a = {
                'wecjT': function (_0x560af9, _0x65b084) {
                    return _0x560af9(_0x65b084);
                },
                'bUtgh': _0x4ab957(0x117) + _0x4ab957(0x180),
                'wpfYP': _0x4ab957(0x138),
                'EuHim': _0x4ab957(0x13c),
                'eUyID': _0x4ab957(0x160),
                'lJnju': _0x4ab957(0x107) + 'pe',
                'OyQuf': _0x4ab957(0x12a),
                'VAyIu': function (_0x1519fa, _0x1acf05) {
                    return _0x1519fa === _0x1acf05;
                },
                'aKAze': _0x4ab957(0x122) + _0x4ab957(0x11d),
                'bOSIb': function (_0x49362a, _0x43369e) {
                    return _0x49362a === _0x43369e;
                },
                'ioLGJ': _0x4ab957(0x110) + 'I'
            };
        var _0x199910;
        try {
            const _0x3f012f = {};
            _0x3f012f[_0x4ab957(0x17a) + 'pe'] = _0xcd4e4a[_0x4ab957(0x14c)];
            const _0x2a83b5 = yield axios_1[_0x4ab957(0x148)][_0x4ab957(0x116)](_0x24cedb[_0x4ab957(0x166)], _0x3f012f), _0x57db92 = _0x2a83b5[_0x4ab957(0x14b)][_0xcd4e4a[_0x4ab957(0xfa)]], _0x3c889c = mime_1[_0x4ab957(0x148)], _0x3208ec = _0x3c889c[_0x4ab957(0x104)](_0x57db92), _0x1cb270 = (-0x2380 + 0xd9d * -0x1 + 0x311d, uuid_1['v4'])(), _0x3b151f = (-0x1ad3 + 0x95 * 0x9 + 0x1596, path_1[_0x4ab957(0x186)])(__dirname, '..', '..', '..', _0xcd4e4a[_0x4ab957(0x126)]), _0x582b36 = _0x1cb270 + '.' + _0x3208ec, _0x3db386 = (0x730 + -0x28f * 0xb + 0x14f5, path_1[_0x4ab957(0x186)])(_0x3b151f, _0x582b36), _0x3da67c = {};
            _0x3da67c[_0x4ab957(0x179) + 'me'] = _0x582b36, _0x3da67c[_0x4ab957(0x12f)] = _0x582b36, _0x3da67c[_0x4ab957(0x169)] = _0x3208ec;
            const _0x4dfed5 = _0x3da67c;
            return yield new Promise((_0x4d24c6, _0x207fdf) => {
                const _0x38ff15 = _0x4ab957;
                _0x2a83b5[_0x38ff15(0x147)][_0x38ff15(0x106)](fs_1[_0x38ff15(0x148)][_0x38ff15(0x13e) + _0x38ff15(0x18b)](_0x3db386))['on'](_0xcd4e4a[_0x38ff15(0x144)], () => __awaiter(void (-0xd17 + -0x2 * 0x985 + 0x2021), void (0x337 + -0xc4d + 0x916), void (0xc9 + -0x1d0 + 0x1 * 0x107), function* () {
                    const _0x334b6d = _0x38ff15;
                    _0xcd4e4a[_0x334b6d(0x128)](_0x4d24c6, _0x4dfed5);
                }))['on'](_0xcd4e4a[_0x38ff15(0x185)], _0x4302ae => {
                    const _0x59b192 = _0x38ff15;
                    console[_0x59b192(0x13c)](_0xcd4e4a[_0x59b192(0x16d)], _0x4302ae);
                    const _0x48a4b6 = {};
                    _0x48a4b6[_0x59b192(0x119)] = !![], fs_1[_0x59b192(0x148)][_0x59b192(0x118)](_0x3db386, _0x48a4b6), _0xcd4e4a[_0x59b192(0x128)](_0x207fdf, new Error(_0x4302ae));
                });
            }), _0x4dfed5;
        } catch (_0x82c85b) {
            if (_0xcd4e4a[_0x4ab957(0x17d)](_0x82c85b[_0x4ab957(0x156)][_0x4ab957(0x14a)], 0x866 * 0x2 + -0x1e89 + 0xf51)) {
                const _0x174bed = {};
                _0x174bed[_0x4ab957(0x146)] = -(-0x49 * 0x31 + 0x15eb * 0x1 + 0x6b * -0x13), _0x174bed[_0x4ab957(0xf4)] = _0x24cedb[_0x4ab957(0xf4)], _0x174bed[_0x4ab957(0x16e)] = '', _0x174bed[_0x4ab957(0x189)] = _0x24cedb[_0x4ab957(0x189)], _0x174bed[_0x4ab957(0x151) + 'y'] = _0x24cedb[_0x4ab957(0x151) + 'y'], _0x174bed[_0x4ab957(0x13c)] = _0x82c85b[_0x4ab957(0x127)], _0x174bed[_0x4ab957(0x10e)] = _0x24cedb[_0x4ab957(0xf8)][_0x4ab957(0x10e)], _0x174bed[_0x4ab957(0x10c)] = _0xcd4e4a[_0x4ab957(0x101)];
                const _0x38f93c = _0x174bed;
                if (_0xcd4e4a[_0x4ab957(0x132)](_0x199910 = _0xcd4e4a[_0x4ab957(0x17d)](_0x24cedb, null) || _0xcd4e4a[_0x4ab957(0x17d)](_0x24cedb, void (0x117f + -0x2614 + 0x1495)) ? void (0x833 + -0x63 + -0x50 * 0x19) : _0x24cedb[_0x4ab957(0xf8)], null) || _0xcd4e4a[_0x4ab957(0x132)](_0x199910, void (0x62 * 0x61 + 0x88c + -0x2dae)) ? void (0x15d * 0x4 + -0xfd6 + 0xa62) : _0x199910[_0x4ab957(0x193) + _0x4ab957(0x133)]) {
                    const _0x2de54b = {};
                    _0x2de54b[_0x4ab957(0x124)] = _0x24cedb[_0x4ab957(0xf8)][_0x4ab957(0x193) + _0x4ab957(0x133)], _0x2de54b[_0x4ab957(0x10c)] = _0x38f93c[_0x4ab957(0x10c)], _0x2de54b[_0x4ab957(0xf6)] = _0x38f93c, Queue_1[_0x4ab957(0x148)][_0x4ab957(0x155)](_0xcd4e4a[_0x4ab957(0xf5)], _0x2de54b);
                }
                return {};
            }
            throw new Error(_0x82c85b);
        }
    }), CreateMessageSystemService = ({
        msg: _0x1240c3,
        tenantId: _0x1308e3,
        medias: _0x27f9b6,
        ticket: _0x48b5df,
        userId: _0x2c5e8a,
        scheduleDate: _0x3e9407,
        sendType: _0x532450,
        status: _0x532744,
        idFront: _0x4f4b5f,
        reaction: _0x46710a,
        isSticker: _0x49359b
    }) => __awaiter(void (-0x1e71 + -0xc17 * 0x3 + 0x42b6), void (-0x70c + 0xb8d * -0x1 + 0x9 * 0x211), void (0x1cd * 0x7 + -0x1db + -0x10 * 0xac), function* () {
        const _0x128a29 = _0x20ebbd, _0x40d4dc = {
                'JwLky': _0x128a29(0x16a),
                'eketw': _0x128a29(0x184),
                'CExCH': _0x128a29(0x163),
                'ShzXF': _0x128a29(0x13f) + _0x128a29(0x14e) + _0x128a29(0x16b),
                'FCvIg': _0x128a29(0x17c) + 'e',
                'Iocmi': function (_0x2ae479, _0x1e87c3) {
                    return _0x2ae479 === _0x1e87c3;
                },
                'PVRNs': _0x128a29(0x14f),
                'Chhsx': _0x128a29(0x12c),
                'JANFK': function (_0x182762, _0x48a8ad) {
                    return _0x182762 === _0x48a8ad;
                },
                'ZxDdB': function (_0x222b28, _0xc4df98) {
                    return _0x222b28 === _0xc4df98;
                },
                'sCUcJ': function (_0x43fb69, _0x5edd5c) {
                    return _0x43fb69 === _0x5edd5c;
                },
                'TYVft': function (_0x4931a1, _0x5a223d) {
                    return _0x4931a1 === _0x5a223d;
                },
                'VRHSE': function (_0xf205fd, _0x12dbf4) {
                    return _0xf205fd === _0x12dbf4;
                },
                'XnAeG': function (_0x282cce, _0x562bbb) {
                    return _0x282cce === _0x562bbb;
                },
                'NSvWD': function (_0x2075e2, _0x4d6114) {
                    return _0x2075e2 === _0x4d6114;
                },
                'EeBSy': function (_0x3eb918, _0x474b09) {
                    return _0x3eb918 === _0x474b09;
                },
                'RfvHW': function (_0x5bf280, _0x6ae4de) {
                    return _0x5bf280 === _0x6ae4de;
                },
                'EjHpQ': function (_0x10e640, _0x1c606a) {
                    return _0x10e640 === _0x1c606a;
                },
                'QdkpY': function (_0x38312c, _0x459c50) {
                    return _0x38312c === _0x459c50;
                },
                'wUWsR': function (_0x5c5a76, _0xd9aaf9) {
                    return _0x5c5a76(_0xd9aaf9);
                },
                'hrItA': _0x128a29(0x125),
                'CJkZX': _0x128a29(0x11b) + _0x128a29(0x178) + _0x128a29(0x187)
            };
        var _0x5c5eef, _0x5a3eff, _0x5c20af, _0x57b454, _0x259a2e, _0x3b579b, _0x51f02e;
        const _0x144abb = {
            'ticketId': _0x48b5df['id'],
            'body': _0x1240c3[_0x128a29(0xf4)],
            'contactId': _0x48b5df[_0x128a29(0xfc)],
            'fromMe': _0x40d4dc[_0x128a29(0x192)](_0x532450, _0x40d4dc[_0x128a29(0x11e)]) ? !![] : _0x40d4dc[_0x128a29(0x192)](_0x1240c3, null) || _0x40d4dc[_0x128a29(0x192)](_0x1240c3, void (0xcfe + 0x1 * -0x6a7 + -0x21d * 0x3)) ? void (0x1c86 + 0x23b3 + -0x1 * 0x4039) : _0x1240c3[_0x128a29(0x10d)],
            'read': !![],
            'mediaType': _0x40d4dc[_0x128a29(0x17b)],
            'mediaUrl': undefined,
            'timestamp': new Date()[_0x128a29(0x190)](),
            'quotedMsgId': _0x40d4dc[_0x128a29(0x192)](_0x5c5eef = _0x40d4dc[_0x128a29(0x192)](_0x1240c3, null) || _0x40d4dc[_0x128a29(0x192)](_0x1240c3, void (-0x76 * 0x1f + -0x8a3 + 0x16ed)) ? void (0xb4d + 0xb * -0x1bb + -0xc6 * -0xa) : _0x1240c3[_0x128a29(0x163)], null) || _0x40d4dc[_0x128a29(0x192)](_0x5c5eef, void (0x144a + -0x53 * -0x6b + -0x36fb)) ? void (-0x1 * -0x1ba9 + -0x8 * 0xad + -0x1b * 0xd3) : _0x5c5eef['id'],
            'userId': _0x2c5e8a,
            'scheduleDate': _0x3e9407,
            'sendType': _0x532450,
            'status': _0x532744,
            'tenantId': _0x1308e3,
            'idFront': _0x4f4b5f,
            'reaction': _0x46710a,
            'isSticker': _0x49359b
        };
        try {
            _0x144abb[_0x128a29(0xf4)] = (0x15d + 0x1dd7 + 0x7cd * -0x4, pupa_1[_0x128a29(0x194)])(_0x1240c3[_0x128a29(0xf4)] || '', {
                'protocol': (_0x40d4dc[_0x128a29(0x192)](_0x48b5df, null) || _0x40d4dc[_0x128a29(0x192)](_0x48b5df, void (-0x1411 + 0x3 * -0x238 + 0x1ab9)) ? void (-0x1 * -0x9a5 + 0x1 * 0x23f3 + -0x2d98) : _0x48b5df[_0x128a29(0x113)]) || '',
                'name': (_0x40d4dc[_0x128a29(0x192)](_0x5a3eff = _0x40d4dc[_0x128a29(0x192)](_0x48b5df, null) || _0x40d4dc[_0x128a29(0x141)](_0x48b5df, void (-0x19d2 + -0xfc9 * -0x2 + 0x5c0 * -0x1)) ? void (0x11 * -0x1df + 0xcb + 0x4 * 0x7c1) : _0x48b5df[_0x128a29(0x184)], null) || _0x40d4dc[_0x128a29(0x141)](_0x5a3eff, void (0x3ca + 0x8 * -0x3a2 + 0x1946)) ? void (0x25 * -0xc1 + -0x9a * -0x2 + -0x1ab1 * -0x1) : _0x5a3eff[_0x128a29(0x18c)]) || '',
                'email': (_0x40d4dc[_0x128a29(0x162)](_0x5c20af = _0x40d4dc[_0x128a29(0x162)](_0x48b5df, null) || _0x40d4dc[_0x128a29(0x112)](_0x48b5df, void (-0x12b * 0x5 + 0x1ddd + 0x1806 * -0x1)) ? void (-0x1199 + 0x306 * 0x9 + -0x99d) : _0x48b5df[_0x128a29(0x184)], null) || _0x40d4dc[_0x128a29(0x141)](_0x5c20af, void (0x1d86 + 0xb * 0x7d + -0x22e5)) ? void (0x2 * -0x939 + -0x2 * -0x7 + 0x1264) : _0x5c20af[_0x128a29(0x130)]) || '',
                'phoneNumber': (_0x40d4dc[_0x128a29(0x112)](_0x57b454 = _0x40d4dc[_0x128a29(0x141)](_0x48b5df, null) || _0x40d4dc[_0x128a29(0x18f)](_0x48b5df, void (0xaf9 * 0x2 + -0x1 * 0x16db + 0xe9)) ? void (-0x1cf5 + -0x1ca0 + 0x1 * 0x3995) : _0x48b5df[_0x128a29(0x184)], null) || _0x40d4dc[_0x128a29(0x188)](_0x57b454, void (0x1 * 0x2d9 + 0x4e8 + -0x1 * 0x7c1)) ? void (0xf * -0xe2 + -0x16db + 0x2419) : _0x57b454[_0x128a29(0x189)]) || '',
                'kanban': (_0x40d4dc[_0x128a29(0x192)](_0x259a2e = _0x40d4dc[_0x128a29(0x176)](_0x48b5df, null) || _0x40d4dc[_0x128a29(0x162)](_0x48b5df, void (0x2d8 * -0xc + 0x2fb * 0x1 + 0x1f25)) ? void (-0x247 * 0xb + 0x107f + 0x88e) : _0x48b5df[_0x128a29(0x184)], null) || _0x40d4dc[_0x128a29(0x17e)](_0x259a2e, void (-0xb5 * 0x1 + 0x4 * 0x400 + -0x91 * 0x1b)) ? void (-0x915 + 0xa7 * 0x3b + -0x1 * 0x1d68) : _0x259a2e[_0x128a29(0x121)]) || '',
                'user': (_0x40d4dc[_0x128a29(0x176)](_0x3b579b = _0x40d4dc[_0x128a29(0x120)](_0x48b5df, null) || _0x40d4dc[_0x128a29(0x12e)](_0x48b5df, void (-0x2 * -0xb56 + 0x3 * -0x49d + -0x8d5)) ? void (-0x24d2 + -0x187b + 0x146f * 0x3) : _0x48b5df[_0x128a29(0x15c)], null) || _0x40d4dc[_0x128a29(0x112)](_0x3b579b, void (-0x1c72 + 0x33c + 0x1cd * 0xe)) ? void (-0x185 + 0x1f61 + -0x1ddc) : _0x3b579b[_0x128a29(0x18c)]) || '',
                'userEmail': (_0x40d4dc[_0x128a29(0x15a)](_0x51f02e = _0x40d4dc[_0x128a29(0x15b)](_0x48b5df, null) || _0x40d4dc[_0x128a29(0x176)](_0x48b5df, void (-0x12dd * 0x1 + -0x4ad + 0x178a)) ? void (0xd8d * -0x1 + -0x3e * -0x14 + 0x8b5) : _0x48b5df[_0x128a29(0x15c)], null) || _0x40d4dc[_0x128a29(0x15a)](_0x51f02e, void (-0xf4d * 0x1 + -0x9 * -0x37c + 0x100f * -0x1)) ? void (0x1273 + -0x5 * -0x725 + -0x2 * 0x1b16) : _0x51f02e[_0x128a29(0x130)]) || ''
            });
            if (_0x40d4dc[_0x128a29(0x18f)](_0x532450, _0x40d4dc[_0x128a29(0x11e)]) && _0x1240c3[_0x128a29(0x166)]) {
                _0x27f9b6 = [];
                const _0x3f9116 = yield _0x40d4dc[_0x128a29(0xf7)](downloadMedia, _0x1240c3);
                _0x27f9b6[_0x128a29(0x102)](_0x3f9116);
            }
            _0x40d4dc[_0x128a29(0x112)](_0x532450, _0x40d4dc[_0x128a29(0x11e)]) && !_0x1240c3[_0x128a29(0x166)] && _0x1240c3[_0x128a29(0x109)] && (_0x27f9b6 = [], _0x27f9b6[_0x128a29(0x102)](_0x1240c3[_0x128a29(0x109)]));
            if (_0x27f9b6)
                yield Promise[_0x128a29(0x153)](_0x27f9b6[_0x128a29(0x11f)](_0x469458 => __awaiter(void (0x216c + -0xdb6 + -0x13b6), void (0x18 * -0x193 + -0x63f * -0x1 + 0xd * 0x26d), void (-0x268b + 0x763 * -0x3 + 0x3cb4), function* () {
                    const _0x3050b3 = _0x128a29;
                    try {
                        if (!_0x469458[_0x3050b3(0x12f)]) {
                            const _0x47fd76 = _0x469458[_0x3050b3(0x13d)][_0x3050b3(0xff)]('/')[0x1975 * -0x1 + 0x24aa * 0x1 + -0xb34][_0x3050b3(0xff)](';')[-0xcf3 + 0x3 * 0x2f6 + 0x411];
                            _0x469458[_0x3050b3(0x12f)] = new Date()[_0x3050b3(0x190)]() + '.' + _0x47fd76;
                        }
                    } catch (_0x2ac541) {
                        logger_1[_0x3050b3(0x11a)][_0x3050b3(0x13c)](_0x2ac541);
                    }
                    const _0xe3b8a3 = Object[_0x3050b3(0x172)](Object[_0x3050b3(0x172)]({}, _0x144abb), {
                            'body': _0x469458[_0x3050b3(0x179) + 'me'],
                            'mediaUrl': _0x469458[_0x3050b3(0x12f)],
                            'mediaType': _0x469458[_0x3050b3(0x169)] || _0x469458[_0x3050b3(0x13d)][_0x3050b3(0x114)](0x2 * -0x2c8 + 0x1e2c + 0x19 * -0xfc, _0x469458[_0x3050b3(0x13d)][_0x3050b3(0x123)]('/'))
                        }), _0x175058 = yield Message_1[_0x3050b3(0x148)][_0x3050b3(0x15f)](_0xe3b8a3), _0xd46aad = {};
                    _0xd46aad[_0x3050b3(0x173)] = _0x1308e3;
                    const _0x161973 = {};
                    _0x161973[_0x3050b3(0xfd)] = Ticket_1[_0x3050b3(0x148)], _0x161973['as'] = _0x40d4dc[_0x3050b3(0x131)], _0x161973[_0x3050b3(0x12d)] = _0xd46aad, _0x161973[_0x3050b3(0x142)] = [_0x40d4dc[_0x3050b3(0x16c)]];
                    const _0xaf25b8 = yield Message_1[_0x3050b3(0x148)][_0x3050b3(0x183)](_0x175058['id'], {
                        'include': [
                            _0x161973,
                            {
                                'model': Message_1[_0x3050b3(0x148)],
                                'as': _0x40d4dc[_0x3050b3(0x154)],
                                'include': [_0x40d4dc[_0x3050b3(0x16c)]]
                            }
                        ]
                    });
                    if (!_0xaf25b8)
                        throw new Error(_0x40d4dc[_0x3050b3(0x10f)]);
                    yield _0x48b5df[_0x3050b3(0x18e)]({
                        'lastMessage': _0xaf25b8[_0x3050b3(0xf4)],
                        'lastMessageAt': new Date()[_0x3050b3(0x190)]()
                    });
                    const _0x15febe = {};
                    _0x15febe[_0x3050b3(0x173)] = _0x1308e3, _0x15febe[_0x3050b3(0x10c)] = _0x40d4dc[_0x3050b3(0x175)], _0x15febe[_0x3050b3(0xf6)] = _0xaf25b8, (0x3 * 0x99b + 0x62 * -0x2a + -0x3 * 0x43f, socketEmit_1[_0x3050b3(0x148)])(_0x15febe);
                })));
            else {
                const _0x43439c = {};
                _0x43439c[_0x128a29(0x169)] = _0x40d4dc[_0x128a29(0x17b)];
                const _0x3cce6b = yield Message_1[_0x128a29(0x148)][_0x128a29(0x15f)](Object[_0x128a29(0x172)](Object[_0x128a29(0x172)]({}, _0x144abb), _0x43439c)), _0x377830 = {};
                _0x377830[_0x128a29(0x173)] = _0x1308e3;
                const _0x34c9be = {};
                _0x34c9be[_0x128a29(0xfd)] = Ticket_1[_0x128a29(0x148)], _0x34c9be['as'] = _0x40d4dc[_0x128a29(0x131)], _0x34c9be[_0x128a29(0x12d)] = _0x377830, _0x34c9be[_0x128a29(0x142)] = [_0x40d4dc[_0x128a29(0x16c)]];
                const _0x57bac2 = yield Message_1[_0x128a29(0x148)][_0x128a29(0x183)](_0x3cce6b['id'], {
                    'include': [
                        _0x34c9be,
                        {
                            'model': Message_1[_0x128a29(0x148)],
                            'as': _0x40d4dc[_0x128a29(0x154)],
                            'include': [_0x40d4dc[_0x128a29(0x16c)]]
                        }
                    ]
                });
                if (!_0x57bac2)
                    throw new Error(_0x40d4dc[_0x128a29(0x10f)]);
                yield _0x48b5df[_0x128a29(0x18e)]({
                    'lastMessage': _0x57bac2[_0x128a29(0xf4)],
                    'lastMessageAt': new Date()[_0x128a29(0x190)](),
                    'answered': !![]
                });
                if (_0x40d4dc[_0x128a29(0x15b)](_0x532450, _0x40d4dc[_0x128a29(0x174)])) {
                    const _0x5f4ff1 = {};
                    _0x5f4ff1[_0x128a29(0x146)] = 0x2, _0x5f4ff1[_0x128a29(0x169)] = _0x40d4dc[_0x128a29(0x174)], _0x57bac2[_0x128a29(0x18e)](_0x5f4ff1);
                }
                const _0x5499a0 = {};
                _0x5499a0[_0x128a29(0x173)] = _0x1308e3, _0x5499a0[_0x128a29(0x10c)] = _0x40d4dc[_0x128a29(0x175)], _0x5499a0[_0x128a29(0xf6)] = _0x57bac2, (-0x1b7f + 0x36 + 0x1b49, socketEmit_1[_0x128a29(0x148)])(_0x5499a0);
            }
        } catch (_0x5f71a4) {
            logger_1[_0x128a29(0x11a)][_0x128a29(0x13c)](_0x40d4dc[_0x128a29(0x181)], _0x5f71a4);
        }
    });
exports[_0x20ebbd(0x148)] = CreateMessageSystemService;