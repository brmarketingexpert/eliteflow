'use strict';
const _0x573a8f = _0xa1d0;
(function (_0x456c03, _0x31d78f) {
    const _0x4c7447 = _0xa1d0, _0x34c37d = _0x456c03();
    while (!![]) {
        try {
            const _0xcffcd4 = parseInt(_0x4c7447(0x188)) / (-0xae7 + 0xef0 + -0x408) + parseInt(_0x4c7447(0x1b3)) / (0x14fa + -0x2440 + -0x28c * -0x6) + -parseInt(_0x4c7447(0x18e)) / (-0x1 * -0x18f3 + -0x258a + 0x2 * 0x64d) * (-parseInt(_0x4c7447(0x1a6)) / (-0x712 + -0x1a4b * 0x1 + 0x2161)) + parseInt(_0x4c7447(0x19a)) / (0x813 + 0xd * -0x17b + -0x5 * -0x23d) * (-parseInt(_0x4c7447(0x1ba)) / (0xe6e + 0x73a + -0x15a2)) + parseInt(_0x4c7447(0x1b7)) / (0x5be + 0x1ea7 + -0x245e) * (-parseInt(_0x4c7447(0x196)) / (-0x5 * 0x79 + 0x1 * 0x2032 + -0x1dcd)) + -parseInt(_0x4c7447(0x1a2)) / (0x246d + 0x65a + 0x2 * -0x155f) * (-parseInt(_0x4c7447(0x1b5)) / (0x208f + 0x10 * -0x1c6 + -0x425)) + -parseInt(_0x4c7447(0x18f)) / (0x3 * 0xe9 + -0xccf * 0x1 + 0xa1f);
            if (_0xcffcd4 === _0x31d78f)
                break;
            else
                _0x34c37d['push'](_0x34c37d['shift']());
        } catch (_0x4eb5d7) {
            _0x34c37d['push'](_0x34c37d['shift']());
        }
    }
}(_0x2ce2, 0x1893c2 + -0x399e5 + -0x5e9f6));
function _0x2ce2() {
    const _0x20278d = [
        'map',
        'sender',
        'kOhMp',
        '8296VeHJBv',
        'all',
        'assign',
        'ndjKf',
        'value',
        'sended',
        '__awaiter',
        'default',
        'throw',
        'findAll',
        'cIUeA',
        'dataValues',
        'chat:ack',
        '3273232eWZEMw',
        'messageId',
        '470qEoCQv',
        'watermark',
        '98IMsfhX',
        'update',
        'apply',
        '36CIwMaz',
        'mediaUrl',
        'qRsWP',
        'sequelize',
        'fault',
        'ls/Ticket',
        'Creib',
        'ls/Contact',
        '1286862HKVhIx',
        'ImoQG',
        '__esModule',
        'iVyxW',
        'Emit',
        'ers/socket',
        '1527gkNeSQ',
        '13592304FLUwZU',
        '__importDe',
        'ack',
        'done',
        'next',
        'timestamp',
        'lYdet',
        '483096ABwuEq',
        'lte',
        'ls/Message',
        'read',
        '1370165Pzwxpq',
        'defineProp',
        'then',
        'erty',
        'CBOqI',
        '../../mode',
        '../../help',
        'MdFeC',
        '140409npVtce'
    ];
    _0x2ce2 = function () {
        return _0x20278d;
    };
    return _0x2ce2();
}
function _0xa1d0(_0x429306, _0x28babe) {
    const _0x443899 = _0x2ce2();
    return _0xa1d0 = function (_0x205a85, _0x6788f5) {
        _0x205a85 = _0x205a85 - (-0x1db8 + 0x1ae4 + 0x458);
        let _0x47a379 = _0x443899[_0x205a85];
        return _0x47a379;
    }, _0xa1d0(_0x429306, _0x28babe);
}
var __awaiter = this && this[_0x573a8f(0x1ac)] || function (_0x3d74a3, _0x502c38, _0x38b2aa, _0x1ed2fa) {
        const _0xb9da43 = _0x573a8f, _0x32fafa = {
                'qRsWP': function (_0x25b805, _0x51d7c1) {
                    return _0x25b805(_0x51d7c1);
                },
                'CBOqI': function (_0x514f5e, _0xd3d2d9) {
                    return _0x514f5e instanceof _0xd3d2d9;
                },
                'Creib': function (_0x5ab24b, _0x16cb57) {
                    return _0x5ab24b(_0x16cb57);
                },
                'lYdet': _0xb9da43(0x1ae)
            };
        function _0x1e2a0(_0x53322e) {
            const _0x5e945e = _0xb9da43, _0x1cc71d = {
                    'cIUeA': function (_0xbf04c6, _0x37dd13) {
                        const _0x3689da = _0xa1d0;
                        return _0x32fafa[_0x3689da(0x1bc)](_0xbf04c6, _0x37dd13);
                    }
                };
            return _0x32fafa[_0x5e945e(0x19e)](_0x53322e, _0x38b2aa) ? _0x53322e : new _0x38b2aa(function (_0x3cc2c9) {
                const _0x45bc1b = _0x5e945e;
                _0x1cc71d[_0x45bc1b(0x1b0)](_0x3cc2c9, _0x53322e);
            });
        }
        return new (_0x38b2aa || (_0x38b2aa = Promise))(function (_0x9aa062, _0x4417e0) {
            const _0x3bdf78 = _0xb9da43, _0x218b96 = {
                    'MdFeC': function (_0x2ed8a0, _0x560594) {
                        const _0x5ab54e = _0xa1d0;
                        return _0x32fafa[_0x5ab54e(0x1bc)](_0x2ed8a0, _0x560594);
                    },
                    'kOhMp': _0x32fafa[_0x3bdf78(0x195)],
                    'ImoQG': function (_0x3dc11f, _0x1e5256) {
                        const _0x41f2e5 = _0x3bdf78;
                        return _0x32fafa[_0x41f2e5(0x1bc)](_0x3dc11f, _0x1e5256);
                    }
                };
            function _0x2fecdb(_0x661535) {
                const _0x415fa0 = _0x3bdf78;
                try {
                    _0x32fafa[_0x415fa0(0x186)](_0x45afd9, _0x1ed2fa[_0x415fa0(0x193)](_0x661535));
                } catch (_0x4a40d2) {
                    _0x32fafa[_0x415fa0(0x1bc)](_0x4417e0, _0x4a40d2);
                }
            }
            function _0x1a8cb9(_0xca1ce0) {
                const _0x363cc9 = _0x3bdf78;
                try {
                    _0x218b96[_0x363cc9(0x1a1)](_0x45afd9, _0x1ed2fa[_0x218b96[_0x363cc9(0x1a5)]](_0xca1ce0));
                } catch (_0x26e53e) {
                    _0x218b96[_0x363cc9(0x189)](_0x4417e0, _0x26e53e);
                }
            }
            function _0x45afd9(_0x5607ff) {
                const _0x4479f8 = _0x3bdf78;
                _0x5607ff[_0x4479f8(0x192)] ? _0x32fafa[_0x4479f8(0x1bc)](_0x9aa062, _0x5607ff[_0x4479f8(0x1aa)]) : _0x32fafa[_0x4479f8(0x1bc)](_0x1e2a0, _0x5607ff[_0x4479f8(0x1aa)])[_0x4479f8(0x19c)](_0x2fecdb, _0x1a8cb9);
            }
            _0x32fafa[_0x3bdf78(0x186)](_0x45afd9, (_0x1ed2fa = _0x1ed2fa[_0x3bdf78(0x1b9)](_0x3d74a3, _0x502c38 || []))[_0x3bdf78(0x193)]());
        });
    }, __importDefault = this && this[_0x573a8f(0x190) + _0x573a8f(0x184)] || function (_0x58b30e) {
        const _0x139f16 = _0x573a8f;
        return _0x58b30e && _0x58b30e[_0x139f16(0x18a)] ? _0x58b30e : { 'default': _0x58b30e };
    };
const _0x278a37 = {};
_0x278a37[_0x573a8f(0x1aa)] = !![], Object[_0x573a8f(0x19b) + _0x573a8f(0x19d)](exports, _0x573a8f(0x18a), _0x278a37);
const sequelize_1 = require(_0x573a8f(0x1bd)), socketEmit_1 = __importDefault(require(_0x573a8f(0x1a0) + _0x573a8f(0x18d) + _0x573a8f(0x18c))), Contact_1 = __importDefault(require(_0x573a8f(0x19f) + _0x573a8f(0x187))), Message_1 = __importDefault(require(_0x573a8f(0x19f) + _0x573a8f(0x198))), Ticket_1 = __importDefault(require(_0x573a8f(0x19f) + _0x573a8f(0x185))), MessengerMarkRead = (_0x238488, _0x3f6d53) => __awaiter(void (0x90f + 0x1f19 + -0x2828), void (-0x22b0 + -0x1093 + 0x4a9 * 0xb), void (-0x251e + -0x9f * -0x35 + 0x433), function* () {
        const _0x37bc3a = _0x573a8f, _0x485f2e = {};
        _0x485f2e[_0x37bc3a(0x1a9)] = _0x37bc3a(0x1b2), _0x485f2e[_0x37bc3a(0x18b)] = _0x37bc3a(0x1ab);
        const _0x1cd6f7 = _0x485f2e, _0x4725e8 = yield Message_1[_0x37bc3a(0x1ad)][_0x37bc3a(0x1af)]({
                'where': {
                    'tenantId': _0x3f6d53,
                    'createdAt': { [sequelize_1['Op'][_0x37bc3a(0x197)]]: new Date(_0x238488[_0x37bc3a(0x199)][_0x37bc3a(0x1b6)]) },
                    'fromMe': !![],
                    'ack': {
                        [sequelize_1['Op']['in']]: [
                            0x572 * 0x1 + -0x7 * -0x5c + -0x7 * 0x123,
                            0x17 * -0x10a + 0x56f * -0x1 + 0x1d57
                        ]
                    }
                },
                'include': [{
                        'model': Ticket_1[_0x37bc3a(0x1ad)],
                        'where': { 'tenantId': _0x3f6d53 },
                        'include': [{
                                'model': Contact_1[_0x37bc3a(0x1ad)],
                                'where': {
                                    'tenantId': _0x3f6d53,
                                    'messengerId': _0x238488[_0x37bc3a(0x1a4)]['id']
                                }
                            }]
                    }]
            });
        yield Promise[_0x37bc3a(0x1a7)](_0x4725e8[_0x37bc3a(0x1a3)](_0x28103f => __awaiter(void (-0xaaf + 0x1d7b + -0x12cc), void (0x1 * -0x13a3 + -0x178a + 0x2b2d), void (0xeac + -0x51 * 0x65 + 0x1149), function* () {
            const _0x1ea312 = _0x37bc3a, _0x38a3ab = {};
            _0x38a3ab[_0x1ea312(0x191)] = 0x3, yield _0x28103f[_0x1ea312(0x1b8)](_0x38a3ab), (-0x1826 + -0x2157 + 0x397d, socketEmit_1[_0x1ea312(0x1ad)])({
                'tenantId': _0x3f6d53,
                'type': _0x1cd6f7[_0x1ea312(0x1a9)],
                'payload': Object[_0x1ea312(0x1a8)](Object[_0x1ea312(0x1a8)]({}, _0x28103f[_0x1ea312(0x1b1)]), {
                    'mediaUrl': _0x28103f[_0x1ea312(0x1bb)],
                    'id': _0x28103f['id'],
                    'timestamp': _0x28103f[_0x1ea312(0x194)],
                    'messageId': _0x28103f[_0x1ea312(0x1b4)],
                    'status': _0x1cd6f7[_0x1ea312(0x18b)],
                    'ack': 0x3
                })
            });
        })));
    });
exports[_0x573a8f(0x1ad)] = MessengerMarkRead;